---
title: インクルード ファイル
description: インクルード ファイル
services: storage
author: tamram
ms.service: storage
ms.topic: include
ms.date: 07/11/2018
ms.author: tamram
ms.custom: include file
ms.openlocfilehash: 86c301748b58e7642df9a738c70b4fe70be3310b
ms.sourcegitcommit: d4c076beea3a8d9e09c9d2f4a63428dc72dd9806
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/01/2018
ms.locfileid: "39400010"
---
ゾーン冗長ストレージ (ZRS) は、1 つのリージョン内の 3 つのストレージ クラスターにデータを同期してレプリケートします。 各ストレージ クラスターは物理的に他のストレージ クラスターと分離されており、それぞれの可用性ゾーン (AZ) 内にあります。 各可用性ゾーンとその中の ZRS クラスターは自律的であり、独立したユーティリティとネットワーク機能を備えています。

ZRS アカウンでデータを保存すると、1 つのゾーンが利用不可になった場合でもデータにアクセスして管理できるようになります。 ZRS はパフォーマンスに優れ、短い待機時間です。 ZRS は、[ローカル冗長ストレージ (LRS)](../articles/storage/common/storage-redundancy-lrs.md) と同じ[スケーラビリティ ターゲット](../articles/storage/common/storage-scalability-targets.md)を実現します。

停電や自然災害によってゾーンのデータ センターが利用不可になった場合でも強力な一貫性、高い持続性、高い可用性が必要なシナリオの場合は、ZRS を検討してください。 ZRS は、ストレージ オブジェクトに年間 99.9999999999% (トゥエルブ ナイン) 以上の持続性を実現します。

可用性ゾーンの詳細については、[Availability Zones の概要](https://docs.microsoft.com/azure/availability-zones/az-overview)に関するページを参照してください。

## <a name="support-coverage-and-regional-availability"></a>サポート範囲とリージョンの可用性
現在、ZRS は標準の[汎用 v2 (GPv2)](../articles/storage/common/storage-account-options.md#general-purpose-v2-accounts) のアカウントの種類をサポートしています。 ZRS は、ブロック BLOB、非ディスク ページ BLOB、ファイル、テーブル、およびキューに使用できます。 さらに、[Storage Analytics](../articles/storage/common/storage-analytics.md) のログと [Storage Metrics](../articles/storage/common/storage-enable-and-view-metrics.md) のすべてに使用できます。

ZRS は、次のリージョンで一般公開されています。

- 米国東部 2
- 米国西部 2
- 米国中部
- 北ヨーロッパ
- 西ヨーロッパ
- フランス中部
- 東南アジア

Microsoft は、今後も ZRS が有効な Azure リージョンを増やす予定です。 新しいリージョンの情報については、[Azure サービスの更新情報](https://azure.microsoft.com/updates/)に関するページを定期的に参照してください。

## <a name="what-happens-when-a-zone-becomes-unavailable"></a>ゾーンが利用不可になった場合

ゾーンが利用不可になった場合でも、データには回復性があります。 Microsoft は、指数バックオフを使用した再試行ポリシーを実装するなど、今後も従来の一時的な障害処理方法を実行することをお勧めします。 ゾーンが利用不可になると、Azure は DNS の再指定などのネットワークの更新を実行します。 このような更新は、完了する前にデータにアクセスしている場合、アプリケーションに影響を与える可能性があります。

ZRS は、複数のゾーンが永続的に影響を受けるリージョンの災害からデータを保護することはできませんが、 データが一時的に利用できなくなった場合は、そのデータの回復性を提供します。 リージョンの災害から保護するには、geo 冗長ストレージ (GRS) を使用することをお勧めします。 GRS の詳細については、「[geo 冗長ストレージ (GRS): Azure Storage のリージョン間レプリケーション](../articles/storage/common/storage-redundancy-grs.md)」を参照してください。

## <a name="converting-to-zrs-replication"></a>ZRS レプリケーションへの変換
現在のところ、LRS、GRS、および RA-GRS 間で移行している限り、Azure portal または Storage Resource Provider API を使用してアカウントの冗長性の種類を変更できます。 ただし、ZRS では、単一のストレージ スタンプからリージョン内の複数のスタンプへと物理的なデータ移動が必要なので、移行は簡単ではありません。 

ZRS との間の移行には、主に 2 つの選択肢があります。 既存のアカウントから新しい ZRS アカウントにデータを手動でコピーまたは移動することができます。 ライブ マイグレーションを依頼することもできます。 いつライブ マイグレーションが完了するかまでは保証されていないので、手動で移行することを強くお勧めします。 手動の移行ルートは、ライブ マイグレーションよりも柔軟性があり、移行のタイミングを管理できます。

手動の移行を実行する場合は、さまざまな選択肢があります。
- AzCopy、ストレージ SDK、信頼性の高いサードパーティのツールなど、既存のツールを使用する
- Hadoop や HDInsight に詳しい場合は、ソースと対象の (ZRS) アカウントの両方をクラスターに接続し、DistCp などを使用してデータ コピー プロセスを大規模に並列化することができます
- いずれかのストレージ SDK を活用して独自のツールを構築する

ただし、手動の移行でアプリケーションのダウンタイムが発生し、管理者側でそれを吸収できない場合には、ライブ マイグレーションを利用することをお勧めします。 ライブ マイグレーションは、ソースと対象のストレージ スタンプ間でデータを移行しながら、既存のストレージ アカウントを引き続き使用できるインプレース移行です。 移行中も、通常と同じレベルの持続性と可用性の SLA を維持できます。

ただし、ライブ マイグレーションには一定の制限があります。 それを以下に示します。

- Microsoft はお客様のライブ マイグレーション依頼に速やかに対応しますが、ライブ マイグレーションがいつ完了するかについての保証はありません。 特定の時間までに ZRS にデータを移行する必要がある場合は、手動で移行する必要があります。 一般的に、アカウントで保存しているデータが多いほど、データの移行には時間がかかります。 
- LRS または GRS レプリケーションを使用しているアカウントからのみ、ライブ マイグレーションを実行できます。 アカウントが RA-GRS を使用している場合は、まずこれらのレプリケーションの種類のいずれかに移行してから、処理を続行する必要があります。 この中間の手順により、RA-GRS が提供する読み取り専用のセカンダリ エンドポイントが移行前に確実に削除されます。
- アカウントにはデータが含まれている必要があります。
- リージョン内の移行のみがサポートされています。 ソース アカウントとは異なるリージョンにある ZRS アカウントにデータを移行する場合は、手動の移行を実行する必要があります。
- Standard ストレージ アカウントの種類のみがサポートされています。 Premium ストレージ アカウントから移行することはできません。

ライブ マイグレーションの依頼は、Azure サポート ポータルから行います。 ポータルから、ZRS に変換するストレージ アカウントを選択します。
1. **[新しいサポート要求]** をクリックします。
2. [基本] を確認します。 **[次へ]** をクリックします。 
3. **[問題]** セクションで、次の操作を行います。 
    - [重大度] はそのままにします。
    - [問題の種類] = **[データ移行]**
    - [カテゴリ] = **[Migrate to ZRS within a region]\(リージョン内の ZRS への移行\)**
    - [タイトル] = **ZRS アカウントの移行** (またはわかりやすい名前)
    - [詳細] = ______ リージョンの [LRS、GRS] から ZRS への移行を依頼します。 
4. **[次へ]** をクリックします。
5. [連絡先情報] ブレードの連絡先情報が正しいことを確認します。
6. **[送信]** をクリックします。

サポート担当者からお客様に連絡を差し上げます。 サポート担当者はお客様に必要な支援を提供します。 

## <a name="zrs-classic-a-legacy-option-for-block-blobs-redundancy"></a>ZRS クラシック: BLOB の冗長性をブロックするレガシー オプション
> [!NOTE]
> ZRS クラシック アカウントは、2021 年 3 月 31 日に非推奨になり、移行が必須になる予定です。 ZRS クラシックのお客様には、非推奨になる前に Microsoft から詳細をご連絡します。 Microsoft は、ZRS クラシックから ZRS への自動移行プロセスを今後提供する予定です。

>[!NOTE]
> 1 つのリージョンで ZRS が[一般公開](#support-coverage-and-regional-availability)されると、その同じリージョンのポータルからは ZRS クラシック アカウントを作成できなくなります。 ただし、Microsoft PowerShell、Azure CLI など他の方法で (つまり、ZRS クラシックが非推奨になるまでは) 作成することができます。

ZRS クラシックでは、1 つから 2 つのリージョン内の複数のデータセンターに、データが非同期的にレプリケートされます。 Microsoft がセカンダリへのフェールオーバーを開始していないと、レプリカを利用できないことがあります。 ZRS クラシックが利用できるのは、[汎用 V1 (GPv1)](../articles/storage/common/storage-account-options.md#general-purpose-v1-accounts) ストレージ アカウントの**ブロック BLOB** に限られるのでご注意ください。 ZRS クラシック アカウントを LRS または GRS のアカウントに変換したり、逆に LRS または GRS のアカウントを ZRS クラシック アカウントに変換したりすることはできません。また、ZRS クラシック アカウントにはメトリック機能やログ機能はありません。

ZRS クラシック アカウントと LRS、GRS、または RA-GRS を相互に変換することはできません。 また、ZRS クラシック アカウントは、メトリックまたはログをサポートしていません。

LRS、ZRS クラシック、GRS、または RA-GRS アカウントとの間で ZRS アカウント データを手動で移行するには、AzCopy、Azure Storage Explorer、Azure PowerShell、または Azure CLI を使用します。 また、Azure Storage クライアント ライブラリのいずれかを使用して、独自の移行ソリューションを構築することもできます。
