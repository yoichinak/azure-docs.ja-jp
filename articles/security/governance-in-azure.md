---
title: Azure でのガバナンス | Microsoft Docs
description: アプリケーションや企業のニーズを満たすためにスケールアップまたはスケールダウンできるクラウドベースのコンピューティング サービスについて説明します。
services: security
documentationcenter: na
author: UnifyCloud
manager: mbaldwin
editor: TomSh
ms.assetid: ''
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/01/2017
ms.author: TomSh
ms.openlocfilehash: 579e900ee6616af8fd197e501364acd8e18d3e37
ms.sourcegitcommit: f606248b31182cc559b21e79778c9397127e54df
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/12/2018
ms.locfileid: "38970525"
---
# <a name="governance-in-azure"></a>Azure でのガバナンス

Azure には多数のセキュリティ オプションと制御機能が用意されており、組織によるデプロイの独自の要件を満たすことができます。

Azure クラウド ガバナンスでは、クラウド コンピューティングのプランニング、アーキテクチャ、取得、デプロイ、運用、管理に関わる意思決定プロセス、基準、およびポリシーを扱います。 Azure クラウド ガバナンスは、組織における Azure プラットフォームの使用状況を確認して通知するための、統合された監査およびコンサルティングの手段を提供します。 

Azure クラウド ガバナンスのプランを作成するには、現在配備されている人員、プロセス、およびテクノロジを詳しく調べる必要があります。 それにより、IT が常にビジネス ニーズを簡単にサポートできるようにし、ユーザーが Azure の機能を柔軟に使用できるようにするフレームワークをビルドできます。

## <a name="implementation-of-policies-processes-and-standards"></a>ポリシー、プロセス、および標準の実装 

管理部門は、Azure 全体で実装されている情報セキュリティ ポリシーと運用の継続性を監視する役割と責任を確立しています。 Azure の管理機能は、それぞれのチーム内 (サード パーティも含む) でのセキュリティと継続性の監視を担っています。 また、セキュリティ ポリシー、プロセス、および標準に対するコンプライアンスも促進します。

### <a name="account-provisioning"></a>アカウント プロビジョニング

アカウント階層の定義は、社内で Azure のサービスを使用および構成するための主要な手順です。 ガバナンス構造の中核をなす部分でもあります。 エンタープライズ契約 (EA) を結んでいる顧客は、環境を部門、アカウント、サブスクリプションにさらに分割できます。

![アカウント プロビジョニング](./media/governance-in-azure/security-governance-in-azure-fig1.png)

エンタープライズ契約がないお客様は、サブスクリプション レベルで [Azure タグ](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-using-tags)を使用して階層を定義することを検討してください。 Azure サブスクリプションは、すべてのリソースが含まれる基本単位です。 また、サブスクリプションによって、Azure 内でのコア数やリソース数などの制限 が定められます。 サブスクリプションには[リソース グループ](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview)を含めることができ、リソース グループにはリソースを含めることができます。 [ロールベースのアクセス制御 (RBAC)](https://docs.microsoft.com/azure/role-based-access-control/overview) の原則は、これら 3 つのレベルで適用されます。

すべての企業は異なります。 エンタープライズ以外の企業では、Azure タグを使用した階層により、Azure を編成する方法に柔軟性がもたらされます。 Azure でリソースをデプロイする前に、階層のモデルを作成し、請求、リソースへのアクセス、および複雑性に対する影響を理解しておく必要があります。

### <a name="subscription-controls"></a>サブスクリプションによる制御

サブスクリプションによって、リソースの使用量がどのように報告、課金されるかが決まります。 個別の請求および支払いごとにサブスクリプションを設定できます。 1 つの Azure アカウントに複数のサブスクリプションを含めることができます。 サブスクリプションを使用して、企業の複数の部門における Azure リソースの使用量を判断することができます。

たとえば、企業に IT 部門、HR 部門、およびマーケティング部門があり、それぞれ異なるプロジェクトを実行しているとします。 その企業は、それぞれの部門での仮想マシンなどの Azure リソースの使用量に基づいて課金できます。 企業はこれにより、各部門のファイナンスを管理できます。

Azure サブスクリプションでは、次の 3 つのパラメーターを設定します。

- 一意のサブスクライバー ID

- 請求先

- 使用可能なリソースのセット

個人の場合、これらのパラメーターには、1 つの Microsoft アカウント ID、クレジット カード番号、およびすべての Azure サービスが含まれます。 マイクロソフトでは、サブスクリプションの種類に応じて使用制限を設けています。

Azure 加入契約の階層では、エンタープライズ契約の範囲内でどのようにサービスを構成するかを定義します。 Enterprise Agreement ポータルでは、組織のニーズに合わせてカスタマイズできる柔軟な階層に基づいて、エンタープライズ契約に関連付けられている Azure リソースへのアクセスを分割することができます。 関連付けられている請求とリソースへのアクセスを把握できるよう、階層のパターンは組織の管理上および地理的な構造と一致させる必要があります。

3 つの高度な階層パターンは、機能、部署、および地理的な位置です。 部門は、アカウントのグループ化のための管理上の構成体です。 各部門内でアカウントにサブスクリプションを割り当てることができます。これにより、Azure での請求と主要な制限 (たとえば VM やストレージ アカウントの数) のためのサイロが作成されます。

![サブスクリプションによる制御](./media/governance-in-azure/security-governance-in-azure-fig2.png)


エンタープライズ契約を結んでいる組織の場合、Azure のサブスクリプションは次の 4 階層になります。

1. エンタープライズ加入契約管理者

2. 部門管理者

3. アカウント所有者

4. サービス管理者

この階層は、次のものを制御します。

- 課金関係。

- アカウント管理。

- RBAC を使用したリソースへのアクセス。

- 境界:

  - 使用量と請求 (プランの数に基づくレート カード)

  - 制限

  - Virtual network

- Azure Active Directory (Azure AD) への添付。 1 つの Azure AD インスタンスには、多数のサブスクリプションを関連付けられます。

- エンタープライズ加入契約アカウントとの関連付け。

### <a name="role-based-access-control"></a>ロールベースのアクセス制御

[RBAC](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles) は、Azure 内のリソースの詳細なアクセス管理を実現します。 RBAC を使用すると、職務に必要な範囲のアクセス権だけをユーザーに付与することができます。 企業は、実際に必要となるアクセス許可を従業員に付与することに注力する必要があります。 アクセス許可が多すぎると、アカウントが攻撃者による悪用の対象になりかねません。 アクセス許可が少なすぎると、従業員が業務を効率的に遂行できなくなる可能性があります。 

すべてのユーザーに Azure サブスクリプションまたはリソースで無制限のアクセス許可を付与するのではなく、特定の操作のみを許可することができます。 たとえば、RBAC を使用して、ある従業員にはサブスクリプションで仮想マシンを管理できるようにし、他の従業員にも同じサブスクリプション内で SQL データベースを管理できるようにすることができます。

アクセスを許可するには、特定のスコープ内のユーザー、グループ、またはアプリケーションにロールを割り当てます。 ロール割り当てのスコープには、サブスクリプション、リソース グループ、または単独のリソースを指定できます。 親スコープでロールが割り当てられると、その親に含まれる子へのアクセス権も付与されます。 たとえば、リソース グループへのアクセス権を持つユーザーは、Web サイト、仮想マシン、サブネットなど、リソース グループに含まれるすべてのリソースを管理できます。 各サブスクリプション内では、最大 2,000 のロールの割り当てを作成できます。

ロールはアクセス許可を集めたものであり、RBAC には複数の組み込みロールが含まれています。 次の組み込みロールは、すべてのリソースの種類に適用されます。

- **所有者**は、他のユーザーへアクセス権を委任する権限を含め、すべてのリソースへのフル アクセス権を持ちます。

- **共同作成者**は、Azure リソースのすべてのタイプを作成および管理できますが、他のユーザーへアクセス権を付与することはできません。

- **閲覧者**は、すべての Azure リソースを表示できます。

Azure 内の残りの組み込みロールは、特定の Azure リソースの管理を許可します。 たとえば、仮想マシンの共同作成者ロールが割り当てられたユーザーには、仮想マシンの作成と管理が許可されます。 すべての組み込みロールとその操作の一覧については、「[RBAC 組み込みのロール](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles)」を参照してください。

RBAC は、Azure portal および Azure Resource Manager API での Azure リソースの管理操作をサポートしています。 多くの場合、RBAC は、Azure リソースのデータ レベルの操作を承認できません。 データ操作に対して RBAC がどのように拡張されているかについて詳しくは、「[ロール定義について](https://docs.microsoft.com/azure/role-based-access-control/role-definitions)」を参照してください。

組み込みロールが特定のアクセス ニーズを満たしていない場合、[カスタム ロールを作成](https://docs.microsoft.com/azure/role-based-access-control/custom-roles)することができます。 組み込みのロールと同様、カスタム ロールは、ユーザー、グループ、アプリケーションに対して、サブスクリプション、リソース グループ、リソースのスコープで割り当てることができます。 カスタム ロールは、[Azure PowerShell](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-powershell)、[Azure CLI](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-cli)、[REST API](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-rest) で作成することができます。

### <a name="resource-management"></a>リソース管理

Azure には、[クラシック](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-deployment-model)と Azure Resource Manager という 2 つのデプロイメント モデルがあります。

クラシック モデルでは、各リソースが個別に存在します。 グループ関連のリソースをまとめる方法はありません。 ソリューションまたはアプリケーションを構成するリソースを手動で追跡し、うまくバランスを取りながら管理する必要があります。 管理の基本単位は、サブスクリプションです。 サブスクリプション内でリソースを分類することが難しいことから、多数のサブスクリプションが作成されています。

Resource Manager デプロイ モデルには、[リソース グループ](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview)の概念が含まれます。 リソース グループとは、共通のライフサイクルが共有されるリソースのコンテナーです。 ソリューションのすべてのリソースか、グループとして管理したいリソースのみを含めることができます。 組織のニーズに合わせてリソースをリソース グループに割り当てる方法を指定してください。

Resource Manager デプロイ モデルにはいくつかの利点があります。

- ソリューションのすべてのサービスを、個別に処理するのではなく、グループとしてデプロイ、管理、監視できます。

- ソリューションをそのライフサイクル全体で繰り返しデプロイできます。また、常にリソースが一貫した状態でデプロイされます。

- リソース グループ内のすべてのリソースにアクセス制御を適用できます。 新しいリソースがリソース グループに追加されたときに、これらのポリシーが自動的に適用されます。

- タグをリソースに適用し、サブスクリプションのすべてのリソースを論理的に整理できます。

- JavaScript Object Notation (JSON) を使用してソリューションのインフラストラクチャを定義できます。 JSON ファイルは Resource Manager テンプレートと呼ばれます。

- 正しい順序でデプロイされるようにリソース間の依存関係を定義できます。

![リソース マネージャー](./media/governance-in-azure/security-governance-in-azure-fig4.png)

テンプレートの推奨事項については、「[Azure Resource Manager テンプレートを作成するためのベスト プラクティス](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-template-best-practices)」を参照してください。

依存関係は Azure Resource Manager によって分析され、確実に正しい順序でリソースが作成されるようにします。 リソースが別のリソースの値に依存する場合 (ディスクのストレージ アカウントを必要とする仮想マシンなど) は、テンプレートで[依存関係を設定](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-define-dependencies)します。

インフラストラクチャの更新にも、テンプレートを使用することができます。 たとえば、ソリューションにリソースを追加したり、既にデプロイされたリソースに構成ルールを追加したりできます。 テンプレートでリソースの作成を指定した際、そのリソースが既に存在する場合は、Resource Manager では、新しい資産を作成する代わりに更新が実行されます。 Resource Manager では、既存の資産が、新しい資産と同じ状態になるよう更新されます。

Resource Manager では、セットアップ時に含まれていなかったソフトウェアのインストールなど、さらなる操作が必要なシナリオのための拡張機能を使用できます。

### <a name="resource-tracking"></a>リソースの追跡

組織のユーザーはサブスクリプションにリソースを追加するので、適切な部門、顧客、環境にリソースを関連付けることがさらに重要になります。 [タグ](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-using-tags)を使用することで、リソースにメタデータを添付できます。 タグを使用して、リソースや所有者に関する情報を提供します。 タグを使用すると、さまざまな方法でリソースを集計し、グループ化できるだけでなく、配賦のためにそのデータを使用することもできます。

リソース グループとリソースが複雑に絡み合っており、これらの資産をわかりやすく視覚化する必要がある場合は、タグを使用してください。 たとえば、組織内で同じロールを果たしているリソース、または同じ部門に属しているリソースにタグを付けることができます。

タグがないと、組織内のユーザーは複数のリソースを作成できるものの、作成したリソースを後で特定して管理することが困難になる場合があります。 たとえば、プロジェクトに関するすべてのリソースを削除したい場合があります。 これらのリソースに対してプロジェクトに関するタグが設定されていない場合、手動で探す必要があります。 タグ付けは、サブスクリプションの不要なコストを削減するための重要な方法です。

タグを共有するために、リソースが同じリソース グループ内に格納されている必要はありません。 組織内のユーザーが類似したタグを誤って適用しないよう (「department」の代わりに「dept」など)、組織内のすべてのユーザーが共通のタグを使用できる独自のタグ分類法を作成することができます。

リソース ポリシーを使用して、組織の標準的なルールを作成することができます。 リソースが適切な値でタグ付けされることを保証するポリシーを作成することができます。

Azure Portal からタグ付きのリソースを表示することもできます。 サブスクリプションの[使用状況レポート](https://docs.microsoft.com/azure/billing/billing-understand-your-bill)にはタグ名と値が含まれるので、タグを使ってコストの計算を分けることができます。

タグの詳細については、「[課金タグ ポリシーのイニシアティブ](../azure-policy/scripts/billing-tags-policy-init.md)」を参照してください。

タグには次の制限事項が適用されます。

- 各リソースまたはリソース グループには、最大で 15 個のタグ キー/値のペアを含めることができます。 この制限は、リソース グループまたはリソースに直接適用されたタグにのみ適用されます。 リソース グループに、それぞれが 15 個のタグ キー/値ペアを持つリソースを多数含めることができます。

- タグの名前は 512 文字に制限されています。

- タグの値は 256 文字に制限されています。

- リソース グループに適用したタグは、そのリソース グループ内のリソースには継承されません。

リソースに関連付ける必要のある値が 15 個を超える場合は、タグ値に JSON 文字列を使用します。 JSON 文字列には、1 つのタグ キーに適用される値を多数含めることができます。

#### <a name="tags-for-billing"></a>課金のタグ

タグを使用して、課金データをグループ化できます。 たとえば、異なる組織向けに複数の VM を実行している場合は、タグを使用して、コスト センターごとに使用状況をグループ化します。 また、タグを使用すると、運用環境で実行されている VM の課金データなどの、ランタイム環境ごとにコストを分類することもできます。

タグに関する情報は、 [Azure Resource Usage API と RateCard API](https://docs.microsoft.com/azure/billing/billing-usage-rate-card-overview) から、あるいはコンマ区切り値 (CSV) ファイルから取得できます。 使用状況ファイルは [Azure アカウント ポータル](https://account.windowsazure.com/)または [EA ポータル](https://ea.azure.com/)からダウンロードします。

課金情報へのプログラムによるアクセスの詳細については、「 [Microsoft Azure リソースの消費を把握する](https://docs.microsoft.com/azure/billing/billing-usage-rate-card-overview)」を参照してください。 REST API の操作については、「 [Azure Billing REST API Reference (Azure Billing REST API リファレンス)](https://msdn.microsoft.com/library/azure/1ea5b323-54bb-423d-916f-190de96c6a3c)」を参照してください。

課金のタグがサポートされているサービスの使用状況 CSV ファイルをダウンロードした場合、タグは Tags 列に表示されます。

### <a name="critical-resource-controls"></a>重要なリソースの管理

組織ではサブスクリプションにコア サービスを追加するので、ビジネスが中断されないように、それらのサービスの可用性を確保することがさらに重要になります。 [リソース ロック](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-lock-resources)を使用すると、変更または削除したときにアプリケーションやクラウド インフラストラクチャに大きな影響を及ぼす価値の高いリソースに対する操作を制限できます。 ロックは、サブスクリプション、リソース グループ、またはリソースに適用できます。 通常は、仮想ネットワーク、ゲートウェイ、ストレージ アカウントなどの基本的なリソースにロックを適用します。

リソース ロックでは、**CanNotDelete** と **ReadOnly** の 2 つの値を現在サポートしています。 **CanNotDelete** では、(適切な権限を持つ) ユーザーはリソースの読み取りまたは変更を引き続き行うことができますが、リソースを削除することはできません。 **ReadOnly** では、許可されたユーザーがリソースを削除することも変更することもできません。

リソース ロックは、管理ウィンドウで実行され、<https://management.azure.com> に送信される操作で構成される操作のみに適用されます。 ロックは、リソースが独自の機能を実行する方法を制限しません。 リソースの変更は制限されますが、リソースの操作は制限されません。 たとえば、SQL データベースに対する **ReadOnly** ロックは、ユーザーによるデータベースの削除または変更を禁止しますが、データベースに対するデータの作成、更新、または削除は禁止しません。

**ReadOnly** を適用すると、読み取り操作のように見えるいくつかの操作には追加のアクションが必要となるため、予期しない結果を招く可能性があります。 たとえば、 **ReadOnly** ロックをストレージ アカウントに設定すると、すべてのユーザーがキーを一覧表示できなくなります。 返されるキーは書き込み操作に使用できるため、キーの一覧表示操作は POST 要求を介して処理されます。

![重要なリソースの管理](./media/governance-in-azure/security-governance-in-azure-fig5.png)

別の例として、**ReadOnly** ロックを Azure App Service リソースに配置すると、Visual Studio のサーバー エクスプローラーの操作には書き込みアクセスが必要となるため、Visual Studio のサーバー エクスプローラーはリソース用のファイルを表示できなくなります。

ロールベースのアクセス制御とは異なり、管理ロックを使用すると、すべてのユーザーとロールに対して制限を適用することができます。 アクセス許可の設定の詳細については、「[RBAC と Azure portal を使用してアクセスを管理する](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-portal)」を参照してください。

親スコープでロックを適用すると、そのスコープ内のすべてのリソースは同じロックを継承します。 後で追加するリソースも、親からロックを継承します。 継承されるロックの中で最も制限の厳しいロックが優先されます。

管理ロックを作成または削除するには、Microsoft.Authorization/ または Microsoft.Authorization/locks/ アクションにアクセスできる必要があります。 組み込みロールのうち、所有者とユーザー アクセス管理者にのみこれらのアクションが許可されています。

### <a name="api-access-to-billing-information"></a>課金情報への API アクセス

Azure Billing API を使用すると、使用状況やリソースに関するデータを、お使いのデータ分析ツールで取得できます。 Azure Resource Usage API と Azure Resource RateCard API は、コストを正確に予測して管理するうえで役立ちます。 これらの API は、Azure Resource Manager が公開している API ファミリに含まれ、リソース プロバイダーとして実装されています。

#### <a name="resource-usage-api-preview"></a>Resource Usage API (プレビュー)

[Azure Resource Usage API](https://msdn.microsoft.com/library/azure/mt219003) を使用すると、Azure の推定消費量データを取得できます。 この API には次の要素が含まれています。

- **RBAC**: [Azure portal](https://portal.azure.com/) または [Azure PowerShell コマンドレット](https://docs.microsoft.com/powershell/azure/overview)を使用して、アクセス ポリシーを構成し、サブスクリプションの使用状況データにアクセスできるユーザーやアプリケーションを指定できます。 呼び出し元は、認証に Azure Active Directory トークンを使用する必要があります。 また、呼び出し元が特定の Azure サブスクリプションの使用状況データにアクセスするには、請求閲覧者、閲覧者、所有者、共同作成者のいずれかのロールに呼び出し元を追加します。

- **時間単位または日単位の集計**: 呼び出し元は、時間単位の増分または日単位の増分のどちらで Azure 使用状況データを取得するかを指定できます。 既定値は日単位です。

- **インスタンス メタデータ (リソース タグなど)**: 完全修飾リソース URI (/subscriptions/{subscription-id}/..) などのインスタンスレベルの詳細情報、リソース グループ情報、リソース タグを取得できます。 これらのメタデータを利用すると、クロス課金のようなユースケースにおいて、プログラムでタグを使って確定的に使用状況を割り当てることができます。

- **リソース メタデータ**: 呼び出し元は、測定名、測定カテゴリ、測定サブカテゴリ、単位、リージョンなどのリソースの詳細情報をもとに、消費内容をより詳しく理解できます。 また、エクスペリエンス全体でデータを関連付けることができるように、現在、Azure Portal、Azure 使用状況 CSV、EA 課金 CSV など、一般公開されているエクスペリエンス全体でリソース メタデータの用語の調整を進めています。

- **すべてのプラン タイプの使用状況**: 従量課金制、MSDN、料金コミットメント、料金クレジット、EA など、すべてのプラン タイプについて使用状況データを取得できます。

#### <a name="resource-ratecard-api"></a>Resource RateCard API

Azure Resource RateCard API を使用して、使用可能な Azure リソースの一覧と、それぞれの推定料金情報を取得できます。 この API には次の要素が含まれています。

- **RBAC**: Azure portal または Azure PowerShell コマンドレットを使用して、アクセス ポリシーを構成し、RateCard データにアクセスできるユーザーやアプリケーションを指定できます。 呼び出し元は、認証に Azure Active Directory トークンを使用する必要があります。 また、呼び出し元が特定の Azure サブスクリプションの使用状況データにアクセスするには、リーダー、所有者、共同作成者のいずれかのロールに呼び出し元を追加します。

- **従量課金制、MSDN、料金コミットメント、料金クレジット プランのサポート (EA はなし)**: この API は、Azure のプラン レベルの料金情報を提供します。 この API の呼び出し元は、プラン情報を渡してリソースの詳細と料金を取得する必要があります。 EA プランには登録ごとにカスタマイズされた料金があるため、現在は EA はサポートされていません。 

#### <a name="scenarios"></a>シナリオ

Usage API と RateCard API を組み合わせると、これらのシナリオが可能になります。

- **月間の Azure 使用量の把握**: Usage API と RateCard API を組み合わせて使うと、月間のクラウドの使用状況をより詳しく把握できます。 時間単位や日単位で使用状況と料金の推定値を分析できます。

- **アラートの設定**: Usage API と RateCard API を使用してクラウドの推定消費量と推定料金を取得し、リソースベースまたは料金ベースのアラートを設定することができます。

- **請求額の予測**: 推定の消費量とクラウド使用量を取得し、Machine Learning アルゴリズムを適用して、課金サイクルの終了時に請求される金額を予測することができます。

- **消費前のコスト分析の実行**: RateCard API を使用して、ワークロードを Azure に移行した場合の想定使用量に対する請求金額を予測できます。 他のクラウドまたはプライベート クラウドに既存のワークロードがある場合、その使用状況を Azure の料金に対応付けることで、より正確な Azure の使用量を取得できます。 この情報をもとに、プランを決め、従量課金制以外のプラン タイプ (料金コミットメントや料金クレジットなど) との比較を行うことができます。

- **What-if 分析の実行**: Azure リソースのリージョンや構成を変えた場合に、コスト効率が高くなるかどうかを判断できます。 Azure リソースのコストは、使用している Azure リージョンによって異なります。 別の Azure プラン タイプの方が Azure リソースの料金が安くなるかどうかについても判断できます。

### <a name="networking-controls"></a>ネットワークの管理

リソースへのアクセスは内部 (企業のネットワーク内) の場合もあれば、外部 (インターネット経由) の場合もあります。 組織のユーザーは誤って不適切な場所にリソースを配置しがちであり、リソースが悪意のあるアクセスにさらされる可能性があります。 オンプレミスのデバイスと同様に、企業は Azure ユーザーが正しく判断できるように適切な制御を追加する必要があります。

![ネットワークの管理](./media/governance-in-azure/security-governance-in-azure-fig6.png)

サブスクリプション ガバナンスのために、次のコア リソースが基本的なアクセス制御を提供します。

#### <a name="network-connectivity"></a>ネットワーク接続

[仮想ネットワーク](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview)は、サブネットのコンテナー オブジェクトです。 必須ではありませんが、仮想ネットワークは、多くの場合、アプリケーションを内部の企業リソースに接続するために使用されます。 Azure Virtual Network サービスでは、仮想ネットワークを使用して Azure リソースを安全に相互接続することができます。

仮想ネットワークとは、クラウド内のユーザー独自のネットワークを表したものです。 仮想ネットワークは、サブスクリプション専用の Azure クラウドを論理的に分離したものです。 仮想ネットワークは、オンプレミス ネットワークに接続することもできます。

Azure 仮想ネットワークの機能を次に示します。

- **分離**: 仮想ネットワークは相互に分離されます。 同じ CIDR アドレス ブロックを使用する開発、テスト、運用環境に個別の仮想ネットワークを作成できます。 逆に、異なる CIDR アドレス ブロックを使用する複数の仮想ネットワークを作成し、ネットワークをまとめて接続することもできます。 仮想ネットワークは、複数のサブネットに分割できます。 Azure では、仮想ネットワークに接続した VM と Azure Cloud Services ロール インスタンスの内部的な名前解決を提供します。 必要に応じて、Azure の内部名前解決を使用する代わりに、独自の DNS サーバーを使用するよう仮想ネットワークを構成できます。

- **インターネット接続**: 仮想ネットワークに接続されているすべての Azure Virtual Machines ロール インスタンスと Cloud Services ロール インスタンスは、既定でインターネットにアクセスできます。 また、必要に応じて、特定のリソースへの着信アクセスを有効にすることもできます。

- **Azure リソース接続**: Cloud Services や VM などの Azure リソースを同じ仮想ネットワークに接続できます。 リソースは、異なるサブネットに存在する場合でも、プライベート IP アドレスを使用して相互に接続できます。 Azure では、サブネット、仮想ネットワーク、オンプレミスのネットワークの間に既定のルーティングを提供しているため、ルートの構成と管理は必要ありません。

- **仮想ネットワーク接続**: 仮想ネットワークを相互に接続できます。 いずれかの仮想ネットワークに接続されているリソースは、あらゆる他の仮想ネットワーク上にあるどのリソースとも通信できます。

- **オンプレミス接続**: 自身のネットワークと Azure との間のプライベート ネットワーク接続、またはインターネットを介したサイト間仮想プライベート ネットワーク (VPN) 接続を通じて、仮想ネットワークをオンプレミス ネットワークに接続できます。

- **トラフィック フィルタリング**: 仮想マシンと Cloud Services のネットワーク トラフィック (着信および送信) を、送信元の IP アドレスとポート、送信先の IP アドレスとポート、およびプロトコルでフィルター処理できます。

- **ルーティング**: 必要に応じて、独自のルートを構成するかネットワーク ゲートウェイ経由で BGP ルートを使用することで、既定の Azure ルーティングをオーバーライドできます。

#### <a name="network-access-controls"></a>ネットワーク アクセス制御

[ネットワーク セキュリティ グループ](https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg) (NSG) はファイアウォールに似ており、リソースがネットワーク上で通信する方法に関するルールを提供します。 ネットワーク セキュリティ グループでは、サブネット (または仮想マシン) がインターネットや同じ仮想ネットワーク内の他のサブネットに接続する方法と条件を制御できます。

ネットワーク セキュリティ グループには、Azure 仮想ネットワークに接続されたリソースへのネットワーク トラフィックを許可または拒否する一連のセキュリティ規則が含まれています。 NSG はサブネットに関連付けることができるほか、クラシック モデルについては個々の VM に、Resource Manager モデルについては VM にアタッチされた個々のネットワーク インターフェイス (NIC) に関連付けることができます。

NSG をサブネットに関連付けた場合、そのサブネットに接続されているすべてのリソースにその NSG のルールが適用されます。 VM や NIC にも NSG を関連付けることで、トラフィックをさらに制限することができます。

## <a name="security-and-compliance-with-organizational-standards"></a>セキュリティおよび組織の標準へのコンプライアンス

企業によってニーズは異なり、どのような企業でもクラウド ソリューションからそれぞれメリットを享受しています。 それにも関わらず、どの企業にも共通するのが、クラウドへの移行に対して基本的な懸念を持っているという点です。 お客様がクラウド プロバイダーに求めるもの:

- **データのセキュリティ保護**: IT リーダーは、クラウドでデータ セキュリティと管理制御を高められることを認識しています。 ただし、まだ、クラウドへの移行によって、現在の社内ソリューションよりもハッカーに対して脆弱になることを懸念しています。

- **データをプライベートにしておく**: クラウド サービスは特有のプライバシー問題が課題となっています。 企業はインフラストラクチャにかかるコストの削減と柔軟性の向上を求めてクラウドへの移行を検討しますが、データの格納場所やユーザー アクセス、およびその使用方法を管理できなくなることを恐れています。

- **データの制御** - 企業は、数多くの革新的なソリューションをデプロイできるというクラウドのメリットを享受しているにも関わらず、データを自分たちで制御できなくなることを心配しています。 最近、法律上または法律外の手段を通じて政府機関が顧客データにアクセスしていることが明らかになりましたが、それにより、一部の CIO はクラウドにデータを置くことに慎重になっています。

- **一段上の透明性**: ビジネスの意思決定者は、セキュリティ、プライバシー、および制御の重要性を理解しています。 ただし、データがどのように格納され、アクセスされ、保護されているかを独自に検証できることも必要としています。

- **コンプライアンスの維持**: 企業がクラウド テクノロジの利用を拡大するにつれ、標準や規制は複雑さを増し、その範囲も広がり続けます。 企業は、そのコンプライアンス基準が満たされていることを知る必要があります。

## <a name="security-configuration-for-monitoring-logging-and-auditing"></a>監視、ログ記録、および監査のセキュリティ構成

Azure サブスクライバーは、複数のデバイスからクラウド環境を管理できます。 これらのデバイスには、管理ワークステーション、開発者の PC、さらにはタスク固有のアクセス許可を持つ特権のあるエンドユーザー デバイスも含まれます。 

管理作業は、Azure Portal など、Web ベースのコンソールを介して実行する場合もあれば、 オンプレミス システムと Azure との間に直接接続が存在し、VPN やターミナル サービス、クライアント アプリケーション プロトコルを介して実行したり、プログラムから Azure Service Management API (SMAPI) を介して実行したりする場合もあります。 また、クライアントのエンドポイントはドメインに参加している場合と、タブレット、スマートフォンなど、管理下にない孤立したデバイスである場合とがあります。

この多様性のために、クラウド デプロイに重大なリスクが生じることがあります。 管理、追跡、監査という管理上の工程が困難になる可能性があります。 そうした選択肢の多さから、クラウド サービスの管理用クライアント エンドポイントの利用に監視の目が行き届かず、セキュリティ上の脅威を招く場合もあります。 インフラストラクチャの開発と管理に共用ワークステーションや個人用ワークステーションを使用することは、Web 閲覧 (水飲み場型攻撃など) や電子メール (ソーシャル エンジニアリング、フィッシングなど) などの予測不可能な脅威要因にさらされる原因となります。

監視、ログ記録、および監査が、管理上の工程を追跡し把握するための基盤をもたらします。 すべてのアクションの詳細な監査は、生成されるデータが大量になるため、常に実行できるとは限りません。 とはいえ、管理ポリシーの効果の監査は積極的に行うことをお勧めします。

Azure Active Directory ドメイン サービス (AD DS) GPO の Azure セキュリティ ガバナンスを使用すると、ファイル共有などの管理者の Windows インターフェイスをすべて制御できます。 監視、ログ記録、監査のプロセスに管理ワークステーションを追加します。 管理者と開発者のすべてのアクセスと使用状況を追跡するようにします。

### <a name="azure-security-center"></a>Azure Security Center

[Azure Security Center](https://docs.microsoft.com/azure/security-center/security-center-intro) は、サブスクリプションでのリソースのセキュリティ状態を一元的に表示します。 リソースの侵害の防止に役立つレコメンデーションを提供します。 また、より詳細なポリシーを設定することもできます。たとえば、特定のリソース グループにポリシーを適用して、企業が対処しようとしているリスクへの対策を調整できます。

![Azure Security Center](./media/governance-in-azure/security-governance-in-azure-fig7.png)

Security Center は、Azure サブスクリプション全体に統合セキュリティの監視とポリシーの管理を提供し、気付かない可能性がある脅威を検出し、セキュリティ ソリューションの広範なエコシステムと連動します。 サブスクリプションのリソースに対して[セキュリティ ポリシー](https://docs.microsoft.com/azure/security-center/security-center-policies)を有効にすると、Security Center は、リソースのセキュリティを分析して潜在的な脆弱性を特定します。 ネットワークの構成に関する情報は、すぐに利用可能になります。

Azure Security Center には、Azure サブスクリプション内のすべてのリソースについてのベスト プラクティス分析とセキュリティ ポリシー管理の組み合わせが表示されます。 これにより、Azure リソース、ネットワーク、およびマルウェア対策プログラムやファイアウォールなどのパートナー ソリューションからセキュリティ データが自動的に収集、分析されるので、セキュリティ チームとリスク責任者はセキュリティの脅威を予防、検出し、これに対処することができます。

さらに、Azure Security Center は、機械学習や動作分析などの高度な分析を適用します。 グローバルな脅威インテリジェンスを使用します。情報源としては、Microsoft の製品とサービス、Microsoft Digital Crimes Unit (DCU)、Microsoft Security Response Center (MSRC)、および外部フィードがあります。 サブスクリプション レベルで広範に[セキュリティ ガバナンス](https://www.credera.com/blog/credera-site/azure-governance-part-4-other-tools-in-the-toolbox/)を適用できます。 または、特定の要件に絞り込み、ポリシー定義を通じて個々のリソースに適用できます。

最後に、Azure Security Center はこれらのポリシーに基づいてリソースのセキュリティ正常性を分析し、この情報を使用して洞察に満ちたダッシュボードを提供し、マルウェアが検出されたときや不正な IP 接続の試みが行われたときにアラートを生成します。 レコメンデーションの適用方法の詳細については、「[Azure Security Center でのセキュリティに関する推奨事項の管理](https://docs.microsoft.com/azure/security-center/security-center-recommendations)」を参照してください。

Azure Security Center は、次の Azure リソースを監視します。

- 仮想マシン (VM) (クラウド サービスを含む)

- 仮想ネットワーク

- SQL データベース

- Azure サブスクリプションに統合済みのパートナー ソリューション (VM 上および [App Service Environment](https://docs.microsoft.com/azure/app-service/app-service-app-service-environments-readme) 上の Web アプリケーション ファイアウォールなど)

最初に Security Center にアクセスするときは、サブスクリプション内のすべての仮想マシンに対してデータ収集が有効になっています。 データ収集を有効のままにしておくことをお勧めしますが、Security Center ポリシーで[無効にする](https://docs.microsoft.com/azure/security-center/security-center-faq)ことができます。

### <a name="log-analytics"></a>Log Analytics

Azure Log Analytics ソフトウェア開発およびサービス チームの情報セキュリティと[ガバナンス プログラム](https://github.com/Microsoft/azure-docs/blob/master/articles/log-analytics/log-analytics-security.md)は、そのビジネス要件をサポートします。 「[Microsoft Azure セキュリティ センター](https://azure.microsoft.com/support/trust-center/)」と「[Microsoft セキュリティ センターのコンプライアンス](https://www.microsoft.com/TrustCenter/Compliance/default.aspx)」に記されているように、法律および規制に従っています。 そこでは、Log Analytics によるセキュリティ要件の確立方法、セキュリティ制御の識別方法、リスクの管理と監視方法についても説明されています。 チームは、ポリシー、標準、手順、およびガイドラインのレビューを毎年行っています。

Log Analytics 開発チームの各メンバーは、正規のアプリケーション セキュリティのトレーニングを受けています。 バージョン コントロール システムは、開発中の各ソフトウェア プロジェクトの保護に役立ちます。

Microsoft には、Microsoft のすべてのサービスを監視して評価する、セキュリティとコンプライアンスのチームがあります。 情報セキュリティ責任者がチームを構成します。彼らは、Log Analytics を開発するエンジニアリング部門とは関係ありません。 セキュリティ責任者は独自の管理チェーンを持っています。 彼らは製品およびサービスの独立した評価を行って、セキュリティとコンプライアンスを確保できるようにします。

Log Analytics のコア機能は、Azure で実行される一連のサービスによって提供されます。 サービスごとに固有の管理機能があり、サービスを組み合わせてさまざまな管理シナリオを実現できます。

![管理用の Azure サービス](./media/governance-in-azure/security-governance-in-azure-fig9.JPG)

これらの管理サービスは、クラウドで設計されました。 これらはすべて Azure でホストされるので、オンプレミスのリソースのデプロイと管理は含まれません。 構成が最小限で済むため、数分で稼働させることができます。

エージェントをデータセンターの Windows または Linux コンピューターに配置すると、エージェントは Log Analytics にデータを送信します。 そこでは、データは、クラウド サービスやオンプレミス サービスから収集されたその他のすべてのデータと共に分析できます。 Azure Backup と Azure Site Recovery を使用すると、クラウドを活用して、オンプレミスのリソースのバックアップと高可用性を実現できます。

![Azure ダッシュボード上の管理サービス](./media/governance-in-azure/security-governance-in-azure-fig8.png)

クラウドの Runbook は通常オンプレミスのリソースにアクセスできませんが、エージェントは、データ センターで Runbook をホストする 1 つ以上のコンピューターにインストールできます。 Runbook を開始するときは、クラウドで実行するかローカル worker で実行するかを指定します。

さまざまなソリューションが Microsoft とパートナーによって提供されており、Azure サブスクリプションに追加して、Log Analytics への投資の価値を高めることができます。 たとえば、Azure は[管理ソリューション](https://docs.microsoft.com/azure/operations-management-suite/operations-management-suite-solutions)を提供しています。これは、1 つ以上の管理サービスを使用することで管理シナリオが実装された、パッケージになった一連のロジックです。

![Azure の管理ソリューションのギャラリー](./media/governance-in-azure/security-governance-in-azure-fig10.png)

パートナーは、アプリケーションとサービスをサポートする独自のソリューションを作成し、Azure Marketplace またはクイック スタート テンプレートを使用してユーザーに提供できます。

## <a name="performance-alerting-and-monitoring"></a>パフォーマンスのアラートと監視

### <a name="alerting"></a>アラート

アラートは、Azure リソースのメトリック、イベント、またはログを監視する方法です。 アラートは、指定した条件が満たされたときに通知します。

アラートは、次のようなサービスで使用できます。

- **Azure Application Insights**: Web テストとメトリックのアラートを有効にします。 詳細については、「[Application Insights のアラートの設定](https://docs.microsoft.com/azure/application-insights/app-insights-alerts)」と「[Web サイトの可用性と応答性の監視](https://docs.microsoft.com/azure/application-insights/app-insights-monitor-web-app-availability)」をご覧ください。

- **Log Analytics**: アクティビティ ログと診断ログの Log Analytics へのルーティングを有効にします。 メトリック、ログなどのアラートの種類が許可されています。 詳細については、「 [Log Analytics のアラート](https://docs.microsoft.com/azure/log-analytics/log-analytics-alerts)」を参照してください。

- **Azure Monitor**: メトリック値とアクティビティ ログ イベントの両方に基づいてアラートを有効にします。 [Azure Monitor REST API](https://msdn.microsoft.com/library/dn931943.aspx) を使用して、アラートを管理できます。 詳細については、[Azure Portal、PowerShell、またはコマンド ライン インターフェイスでのアラートの作成](https://docs.microsoft.com/azure/monitoring-and-diagnostics/insights-alerts-portal)に関するページをご覧ください。

### <a name="monitoring"></a>監視

クラウド アプリのパフォーマンスの問題は、ビジネスに影響を及ぼす場合があります。 複数の相互接続されたコンポーネントや頻繁なリリースにより、いつでもパフォーマンスの低下が生じる可能性があります。 さらに、アプリを開発している場合、通常、テストで見つからなかった問題はユーザーによって発見されます。 このような問題について即座に把握し、問題を診断して修正するためのツールを用意しておく必要があります。

Azure のアプリケーションとサービスを監視するためにさまざまなツールがあります。 それらの機能の一部は重複しています。 これは、アプリケーションの開発と運用の間のずれによるものもあります。

主なツールを次に示します。

- **Azure Monitor** は、Azure 上で実行されているサービスを監視するための基本的なツールです。 サービスのスループットと周辺環境に関するインフラストラクチャ レベルのデータが示されます。 アプリをすべて Azure で管理しているのであれば、リソースのスケールアップやスケールダウンを検討する際、Azure Monitor が役立ちます。

- **Application Insights** は、開発に使用することも、運用環境の監視ソリューションとして使用することもできます。 これは、アプリにパッケージをインストールすると動作します。これにより、状況のより詳しい情報が示されます。 Application Insights のデータには、依存関係、例外トレース、スナップショットのデバッグ、実行プロファイルの応答時間が含まれます。 Application Insights には、このテレメトリすべてを分析するためのツールが用意されているため、アプリをデバッグする場合にも、ユーザーがそのアプリで行っている操作を把握する場合にも役立ちます。 応答時間の急激な増加の原因がアプリにあるのか、外部リソースの問題にあるのかを見分けることができます。 Visual Studio を使用していて、アプリに問題がある場合は、その問題を修正できるように問題のコード行にすぐに移動します。

- **Log Analytics** は、運用環境で実行されているアプリケーションのパフォーマンスの調整とメンテナンスの計画を必要とするユーザー向けです。 多くのソースからデータを収集して集計しますが、10 ～ 15 分の待ち時間を伴います。 Log Analytics では、Azure、オンプレミス、サード パーティ製のクラウドベースのインフラストラクチャ (Amazon ウェブ サービスなど) に対応する包括的な IT 管理ソリューションを提供しています。 また、多くのソース間でデータを分析するためのツールを提供し、すべてのログを対象とした複雑なクエリを可能にして、指定された条件で事前に通知することができます。 カスタム データも中央リポジトリに収集して、照会および視覚化できます。

- **System Center Operations Manager** は、大規模なクラウド インストールの管理と監視向けです。 オンプレミスの Windows Server および Hyper-V ベースのクラウド用の管理ツールとして既に使い慣れているかもしれませんが、Azure アプリと統合したり Azure アプリを管理したりすることもできます。 特に重要なこととして、既存のライブ アプリに Application Insights をインストールできます。 アプリがダウンすると、Operations Manager はすぐに通知します。


## <a name="next-steps"></a>次の手順

- [Azure Resource Manager テンプレートを作成するためのベスト プラクティス](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-template-best-practices)

- [Azure サブスクリプション ガバナンスの実装例](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-subscription-examples)

- [Microsoft Azure Government](https://docs.microsoft.com/azure/azure-government/)
