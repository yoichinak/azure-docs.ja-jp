---
title: Microsoft Azure StorSimple 8000 シリーズ デバイスの StorSimple ストレージ アカウント資格情報を管理する | Microsoft Docs
description: StorSimple デバイス マネージャーの [構成] ページを使用してストレージ アカウントを追加、編集、または削除する方法や、ストレージ アカウントのセキュリティ キーのローテーションを行う方法について説明します。
services: storsimple
documentationcenter: NA
author: alkohli
manager: timlt
editor: ''
ms.assetid: ''
ms.service: storsimple
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: TBD
ms.date: 06/29/2017
ms.author: alkohli
ms.openlocfilehash: 36058ad69ea670998b50cf9038741c294a5b79ab
ms.sourcegitcommit: 0a84b090d4c2fb57af3876c26a1f97aac12015c5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/11/2018
ms.locfileid: "38688730"
---
# <a name="use-the-storsimple-device-manager-service-to-manage-your-storage-account-credentials"></a>StorSimple デバイス マネージャー サービスを使用してストレージ アカウント資格情報を管理する

## <a name="overview"></a>概要

StorSimple デバイス マネージャー サービス ブレードの **[構成]** セクションには、StorSimple デバイス マネージャー サービスで作成できるすべてのグローバル サービス パラメーターが表示されます。 これらのパラメーターはこのサービスに接続されているすべてのデバイスに適用でき、次のものが含まれます。

* ストレージ アカウントの資格情報
* 帯域幅テンプレート 
* アクセス制御レコード 

このチュートリアルでは、ストレージ アカウント資格情報を追加、編集、または削除する方法や、ストレージ アカウントのセキュリティ キーのローテーションを行う方法について説明します。

 ![ストレージ アカウントの資格情報の一覧](./media/storsimple-8000-manage-storage-accounts/createnewstorageacct6.png)  

ストレージ アカウントには、クラウド サービス プロバイダーを使用してストレージ アカウントにアクセスするために StorSimple デバイスで使用される資格情報が含まれます。 Microsoft Azure ストレージ アカウントの場合、これらはアカウント名やプライマリ アクセス キーなどの資格情報です。 

**[ストレージ アカウント資格情報]** ブレードには、課金サブスクリプションに対して作成されるすべてのストレージ アカウントが表形式で表示されます。これには次のような情報が含まれます。

* **[名前]** - アカウントの作成時に割り当てられた一意の名前。
* **[SSL が有効]** - SSL が有効で、デバイスとクラウドの間の通信がセキュア チャネル経由かどうか。
* **[使用元]** - ストレージ アカウントを使用しているボリュームの数。

実行できるストレージ アカウント関連の最も一般的なタスクは、次のとおりです。

* ストレージ アカウントの追加 
* ストレージ アカウントの編集 
* ストレージ アカウントを削除する 
* ストレージ アカウントのキー ローテーション 

## <a name="types-of-storage-accounts"></a>ストレージ アカウントの種類

StorSimple デバイスで使用できるストレージ アカウントには、次の 3 つの種類があります。

* **自動生成されたストレージ アカウント** - 名前のとおり、このストレージ アカウントは、サービスが最初に作成されるときに自動的に生成されます。 このストレージ アカウントの作成方法の詳細については、「[オンプレミスの StorSimple デバイスのデプロイ](storsimple-8000-deployment-walkthrough-u2.md)」の「[手順 1. 新しいサービスを作成する](storsimple-8000-deployment-walkthrough-u2.md#step-1-create-a-new-service)」をご覧ください。 
* **サービス サブスクリプションのストレージ アカウント** - サービスと同じサブスクリプションに関連付けられている Azure ストレージ アカウントです。 このストレージ アカウントの作成方法の詳細については、 [Azure ストレージ アカウント](../storage/common/storage-create-storage-account.md)に関するページを参照してください。 
* **サービス サブスクリプションの外部のストレージ アカウント** - これらは、サービスに関連付けられていない、サービスが作成される前に存在していた可能性のある Azure ストレージ アカウントです。

## <a name="add-a-storage-account"></a>ストレージ アカウントの追加

ストレージ アカウントを追加するには、一意の表示名と、(指定されたクラウド サービス プロバイダーによって) ストレージ アカウントにリンクされているアクセス資格情報を指定します。 SSL (Secure Sockets Layer) モードを有効にして、デバイスとクラウド間のネットワーク通信用にセキュリティで保護されたチャネルを作成することもできます。

特定のクラウド サービス プロバイダーに対して複数のアカウントを作成できます。 ただし、ストレージ アカウントを作成した後はクラウド サービス プロバイダーを変更できないことに注意してください。

ストレージ アカウントの保存中、サービスは、クラウド サービス プロバイダーとの通信を試みます。 この時点で、資格情報と指定したアクセス マテリアルが認証されます。 ストレージ アカウントは、認証が成功した場合にのみ作成されます。 認証に失敗した場合は、適切なエラー メッセージが表示されます。

Azure ストレージ アカウントの資格情報を追加するには、次の手順を使用します。

* デバイス マネージャー サービスと同じ Azure サブスクリプションを持つ、ストレージ アカウントの資格情報を追加するには
* デバイス マネージャー サービス サブスクリプション外のストレージ アカウントの資格情報を追加するには

[!INCLUDE [add-a-storage-account-update2](../../includes/storsimple-8000-configure-new-storage-account-u2.md)]

#### <a name="to-add-an-azure-storage-account-credential-outside-of-the-storsimple-device-manager-service-subscription"></a>StorSimple デバイス マネージャー サービス サブスクリプション外の Azure ストレージ アカウント資格情報を追加するには

1. StorSimple デバイス マネージャー サービスに移動し、それを選択してダブルクリックします。 **[概要]** ブレードが開きます。
2. **[構成]** セクションで **[ストレージ アカウントの資格情報]** を選択します。 これにより、StorSimple デバイス マネージャー サービスに関連付けられている、既存のストレージ アカウント資格情報の一覧が表示されます。
3. **[追加]** をクリックします。
4. **[ストレージ アカウント資格情報の追加]** ブレードで、次の手順を実行します。
   
    1. **[サブスクリプション]** で **[その他]** を選択します。
   
    2. Azure ストレージ アカウントの資格情報の名前を指定します。
   
    3. **[ストレージ アカウントのアクセス キー]** ボックスで、Azure ストレージ アカウント資格情報のプライマリ アクセス キーを指定します。 このキーを取得するには、Azure Storage サービスでストレージ アカウントの資格情報を選択し、**[アカウント キーの管理]** をクリックします。 プライマリ アクセス キーをコピーできるようになります。
   
    4. SSL を有効にするには、**[有効にする]** をクリックして、StorSimple デバイス マネージャー サービスとクラウドの間のネットワーク通信用にセキュリティで保護されたチャネルを作成します。 **[無効にする]** は、プライベート クラウド内で動作している場合にのみクリックします。
   
    5. **[追加]** をクリックします。 ストレージ アカウントの資格情報が正常に作成されると、その旨が通知が表示されます。

5. 新しく作成されたストレージ アカウントの資格情報が、StorSimple デバイス マネージャー サービスの構成ブレードの **[ストレージ アカウントの資格情報]** に表示されます。
   


## <a name="edit-a-storage-account"></a>ストレージ アカウントの編集

ボリューム コンテナーで使用されるストレージ アカウントを編集できます。 現在使用中のストレージ アカウントを編集する場合、変更できるフィールドは、ストレージ アカウントのアクセス キーに限られます。 新しいストレージ アクセス キーを指定し、更新された設定を保存できます。

#### <a name="to-edit-a-storage-account"></a>ストレージ アカウントを編集するには

1. StorSimple デバイス マネージャー サービスに移動します。 **[構成]** セクションで **[ストレージ アカウントの資格情報]** をクリックします。

    ![ストレージ アカウントの資格情報](./media/storsimple-8000-manage-storage-accounts/editstorageacct1.png)

2. **[ストレージ アカウントの資格情報]** ブレードで、ストレージ アカウント資格情報の一覧から編集する資格情報を選択してクリックします。 

3. **[SSL を有効にする]** の設定を変更できます。 さらに、**[More...]\(その他...\)** をクリックし、ストレージ アカウントのアクセス キー **[Sync access key]\(アクセス キーの同期\)** を選択してストレージ アカウントのアクセス キーのローテーションを行うこともできます。 キーのローテーションを行う方法の詳細については、「[ストレージ アカウントのキー ローテーション](#key-rotation-of-storage-accounts)」を参照してください。 設定を変更したら、**[保存]** をクリックします。 

    ![編集したストレージ アカウント資格情報を保存する](./media/storsimple-8000-manage-storage-accounts/editstorageacct3.png)

4. 確認を求められたら、 **[はい]** をクリックします。 

    ![変更を確認する](./media/storsimple-8000-manage-storage-accounts/editstorageacct4.png)

設定が更新され、ストレージ アカウントに保存されます。 

## <a name="delete-a-storage-account"></a>ストレージ アカウントを削除する

> [!IMPORTANT]
> ストレージ アカウントは、ボリューム コンテナーで使用されていない場合にのみ削除できます。 ストレージ アカウントがボリューム コンテナーで使用されている場合は、最初にボリューム コンテナーを削除し、次に関連するストレージ アカウントを削除します。

#### <a name="to-delete-a-storage-account"></a>ストレージ アカウントを削除するには

1. StorSimple デバイス マネージャー サービスに移動します。 **[構成]** セクションで **[ストレージ アカウントの資格情報]** をクリックします。

2. ストレージ アカウントの表形式のリストで、削除するアカウントにマウス ポインターを合わせます。 右クリックしてコンテキスト メニューを呼び出し、**[削除]** を選択します。

    ![ストレージ アカウント資格情報を削除する](./media/storsimple-8000-manage-storage-accounts/deletestorageacct1.png)

3. 確認を求めるメッセージが表示されたら、 **[はい]** をクリックして削除操作を続行します。 表形式のリストが更新され、変更が反映されます。

    ![削除の確定](./media/storsimple-8000-manage-storage-accounts/deletestorageacct2.png)

## <a name="key-rotation-of-storage-accounts"></a>ストレージ アカウントのキー ローテーション

セキュリティ上の理由から、データ センターではキー ローテーションが必要になることがよくあります。 ストレージ アカウントは、各 Microsoft Azure サブスクリプションにつき 1 つまたは複数作成できます。 これらのアカウントへのアクセスは、各ストレージ アカウントのサブスクリプションとアクセス キーによって制御されます。 

ストレージ アカウントを作成するときに、Microsoft Azure によって 2 つの 512 ビット ストレージ アクセス キーが生成されます。これらは、ストレージ アカウントにアクセスするときに認証の目的で使用されます。 2 つのストレージ アクセス キーがあると、ストレージ サービスまたはそのサービスへのアクセスを中断することなくキーを再生成できます。 現在使用されているキーは*プライマリ* キーと呼ばれ、バックアップ キーは*セカンダリ* キーと呼ばれます。 Microsoft Azure StorSimple デバイスがクラウド ストレージ サービス プロバイダーにアクセスするときは、これら 2 つのキーのどちらかを指定する必要があります。

## <a name="what-is-key-rotation"></a>キーのローテーションとは

通常、アプリケーションは、キーの 1 つだけを使用してデータにアクセスします。 一定の期間が経過した後、アプリケーションで使用するキーを 2 番目のキーに切り替えることができます。 アプリケーションを 2 番目のキーに切り替えた後、最初のキーを廃棄して新しいキーを生成できます。 2 つのキーをこの方法で使用することにより、アプリケーションはダウンタイムなしでデータにアクセスできます。

ストレージ アカウント キーは、常に、暗号化された形式でサービスに格納されます。 ただし、これらは、StorSimple デバイス マネージャー サービスを使用してリセットできます。 このサービスは、Storage サービスで作成されたアカウントや、StorSimple デバイス マネージャー サービスが最初に作成されたときに生成された既定のストレージ アカウントなど、同じサブスクリプション内のすべてのストレージ アカウントのプライマリ キーとセカンダリ キーを取得できます。 StorSimple デバイス マネージャー サービスは常に、Azure クラシック ポータルからこれらのキーを取得し、暗号化して格納します。

## <a name="rotation-workflow"></a>ローテーションのワークフロー

Microsoft Azure 管理者は、(Microsoft Azure Storage サービス経由で) ストレージ アカウントに直接アクセスすることによって、プライマリ キーまたはセカンダリ キーを再生成または変更できます。 この変更は、StorSimple デバイス マネージャー サービスでは自動的に認識されません。

StorSimple デバイス マネージャー サービスにこの変更を認識させるには、StorSimple デバイス マネージャー サービスにアクセスし、ストレージ アカウントにアクセスし、(変更されたキーに応じて) プライマリ キーまたはセカンダリ キーを同期する必要があります。 その後、サービスは最新のキーを取得し、キーを暗号化して、デバイスに送信します。

#### <a name="to-synchronize-keys-for-storage-accounts-in-the-same-subscription-as-the-service"></a>サービスと同じサブスクリプション内のストレージ アカウントのキーを同期するには 
1. StorSimple デバイス マネージャー サービスに移動します。 **[構成]** セクションで **[ストレージ アカウントの資格情報]** をクリックします。
2. ストレージ アカウントの表形式のリストから、変更するものをクリックします。 

    ![キーの同期](./media/storsimple-8000-manage-storage-accounts/syncaccesskey1.png)

3. **[...More]\(...その他\)** をクリックし、ローテーションを実行するために **[Sync access key]\(アクセスキーの同期\)** を選択します。   

    ![キーの同期](./media/storsimple-8000-manage-storage-accounts/syncaccesskey2.png)

4. StorSimple デバイス マネージャー サービスで、Microsoft Azure Storage サービスで以前に変更されたキーを更新する必要があります。 プライマリ アクセス キーが変更 (再生成) されている場合は、**[プライマリ]** キーを選択します。 セカンダリ キーが変更されている場合は、**[セカンダリ]** キーを選択します。 **[キーの同期]** をクリックします。
      
      ![キーの同期](./media/storsimple-8000-manage-storage-accounts/syncaccesskey3.png)

キーが正常に同期されると、通知が表示されます。

#### <a name="to-synchronize-keys-for-storage-accounts-outside-of-the-service-subscription"></a>サービス サブスクリプションの外部のストレージ アカウントのキーを同期するには
1. **[サービス]** ページで、**[構成]** タブをクリックします。
2. **[ストレージ アカウントの追加/編集]** をクリックします。
3. ダイアログ ボックスで、次の操作を行います。
   
   1. アクセス キーを更新するストレージ アカウントを選択します。
   2. ストレージ アクセス キーは、StorSimple デバイス マネージャー サービスで更新する必要があります。 この場合は、ストレージ アクセス キーを見ることができます。 **[ストレージ アカウントのアクセス キー]** ボックスに新しいキーを入力します。 
   3. 変更を保存します。 ストレージ アカウント アクセス キーが更新されます。

## <a name="next-steps"></a>次の手順
* [StorSimple のセキュリティの詳細](storsimple-8000-security.md)
* [StorSimple デバイス マネージャー サービスを使用した StorSimple デバイスの管理](storsimple-8000-manager-service-administration.md)の詳細

