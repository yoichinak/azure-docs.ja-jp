---
title: ギャラリー以外のアプリケーションのフェデレーション シングル サインオンを構成する方法 | Microsoft Docs
description: Azure AD と統合する、ギャラリー以外のカスタム アプリケーションのフェデレーション シングル サインオンを構成する方法
services: active-directory
documentationcenter: ''
author: barbkess
manager: mtillman
ms.assetid: ''
ms.service: active-directory
ms.component: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 07/11/2017
ms.author: barbkess
ms.openlocfilehash: badbec991230ca13a85088a79fb6e67eb2d71e68
ms.sourcegitcommit: f86e5d5b6cb5157f7bde6f4308a332bfff73ca0f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/31/2018
ms.locfileid: "39367217"
---
# <a name="how-to-configure-federated-single-sign-on-for-a-non-gallery-application"></a>ギャラリー以外のアプリケーションのフェデレーション シングル サインオンを構成する方法

"*コードの記述なしで*" ギャラリー以外のアプリケーションのシングル サインオンを構成するには、サブスクリプションまたは Azure AD Premium を持っており、アプリケーションが SAML 2.0 をサポートしている必要があります。 Azure AD のバージョンの詳細については、[Azure AD の価格](https://azure.microsoft.com/pricing/details/active-directory/)に関するページを参照してください。

## <a name="overview-of-steps-required"></a>必要な手順の概要
以下は、ギャラリー以外の (たとえばカスタム) アプリケーションの SAML 2.0 を使用するフェデレーション シングル サインオンの構成に必要な手順の概要です。

-   [Azure AD で、アプリケーションのメタデータ値を構成する (サインオン URL、識別子、応答 URL)](#_Configuring_single_sign-on)

-   [ユーザー識別子を選択し、アプリケーションに送信するためのユーザー属性を追加する](#select-user-identifier-and-add-user-attributes-to-be-sent-to-the-application)

-   [Azure AD メタデータと証明書を取得する](#download-the-azure-ad-metadata-or-certificate)

-   [アプリケーションで Azure AD メタデータ値を構成する (サインオン URL、発行者、ログアウト URL、証明書)](#_Configuring_single_sign-on)

-   [アプリケーションにユーザーを割り当てる](#_Assign_users_to_the_application)

## <a name="configuring-single-sign-on-to-non-gallery-applications"></a>ギャラリー以外のアプリケーションにシングル サインオンを構成する

Azure AD ギャラリーに含まれていないアプリケーションのシングル サインオンを構成するには、次の手順に従います。

1.  [**Azure Portal**](https://portal.azure.com/) を開き、**グローバル管理者**または**共同管理者**としてサインインします。

2.  左側のメイン ナビゲーション メニューの上部にある **[すべてのサービス]** をクリックして **[Azure Active Directory 拡張機能]** を開きます。

3.  フィルター検索ボックスに「**Azure Active Directory**」と入力し、**[Azure Active Directory]** 項目を選択します。

4.  Azure Active Directory の左側のナビゲーション メニューから **[エンタープライズ アプリケーション]** をクリックします。

5.  **[エンタープライズ アプリケーション]** ウィンドウの右上隅にある **[追加]** ボタンをクリックします。

6.  **[自分のアプリを追加]** セクションで、**[非ギャラリー アプリケーション]** をクリックします。

7.  **[名前]** ボックスに、アプリケーションの名前を入力します。

8.  **[追加]** ボタンをクリックして、アプリケーションを追加します。

9.  アプリケーションが読み込まれたら、アプリケーションの左側のナビゲーション メニューから **[シングル サインオン]** をクリックします。

10. **[モード]** ボックスの一覧から、**[SAML ベースのサインオン]** を選択します。

11. **[ドメインおよび URL]** に必要な値を入力します。 これらの値は、アプリケーション ベンダーから取得する必要があります。

   1. IdP によって開始された SSO としてアプリケーションを構成するには、応答 URL と識別子を入力します。

   2. **省略可能:** SP によって開始された SSO としてアプリケーションを構成するには、サインオン URL が必要な値です。

12. **[ユーザー属性]** で、**[ユーザー識別子]** ボックスの一覧からユーザーの一意の識別子を選択します。

13. **省略可能:** **[その他のすべてのユーザー属性を表示および編集する]** をクリックして、ユーザーがサインインするときに SAML トークンでアプリケーションに送信される属性を編集します。

   属性を追加するには、次の手順に従います。

   1. **[属性の追加]** をクリックします。 **[名前]** を入力し、ドロップダウンから **[値]** を選択します。

   2. **[保存]** をクリックします。 テーブルに新しい属性が表示されます。

14. アプリケーションでシングル サインオンを構成する方法に関するドキュメントにアクセスするには、**[&lt;アプリケーション名&gt; の構成]** をクリックします。 また、アプリケーションに必要な Azure AD URL と証明書が用意されています。

15. [アプリケーションにユーザーを割り当てます。](#assign-users-to-the-application)

## <a name="select-user-identifier-and-add-user-attributes-to-be-sent-to-the-application"></a>ユーザー識別子を選択し、アプリケーションに送信するためのユーザー属性を追加する

ユーザー識別子を選択したり、ユーザー属性を追加したりするには、次の手順に従います。

1.  [**Azure Portal**](https://portal.azure.com/) を開き、**グローバル管理者**または**共同管理者**としてサインインします。

2.  左側のメイン ナビゲーション メニューの上部にある **[すべてのサービス]** をクリックして **[Azure Active Directory 拡張機能]** を開きます。

3.  フィルター検索ボックスに「**Azure Active Directory**」と入力し、**[Azure Active Directory]** 項目を選択します。

4.  Azure Active Directory の左側のナビゲーション メニューから **[エンタープライズ アプリケーション]** をクリックします。

5.  **[すべてのアプリケーション]** をクリックして、すべてのアプリケーションの一覧を表示します。

  * ここに表示したいアプリケーションが表示されない場合は、**[All Applications List (すべてのアプリケーション リスト)]** の上部にある **[フィルター]** コントロールを使用して、**[表示]** オプションを **[すべてのアプリケーション]** に設定します。

6.  シングル サインオンを構成したアプリケーションを選択します。

7.  アプリケーションが読み込まれたら、アプリケーションの左側のナビゲーション メニューから **[シングル サインオン]** をクリックします。

8.  **[ユーザー属性]** セクションで、**[ユーザー識別子]** ボックスの一覧からユーザーの一意の識別子を選択します。 選択したオプションは、ユーザーを認証するアプリケーションで想定されている値と一致する必要があります。

 >[!注} Azure AD は、選択した値に基づく NameID 属性 (ユーザー ID) の形式、または SAML AuthRequest でアプリケーションによって要求された形式を選択します。 詳細については、「[シングル サインオンの SAML プロトコル](https://docs.microsoft.com/azure/active-directory/develop/active-directory-single-sign-on-protocol-reference#authnrequest)」の「NameIDPolicy」セクションを参照してください。
 >
 >

9.  ユーザー属性を追加するには、**[その他のすべてのユーザー属性を表示および編集する]** をクリックして、ユーザーがサインインするときに SAML トークンでアプリケーションに送信される属性を編集します。

   属性を追加するには、次の手順に従います。

   1. **[属性の追加]** をクリックします。 **[名前]** を入力し、ドロップダウンから **[値]** を選択します。

   2. **[保存]** をクリックします。 テーブルに新しい属性が表示されます。

## <a name="download-the-azure-ad-metadata-or-certificate"></a>Azure AD メタデータまたは証明書をダウンロードする

Azure AD からアプリケーションのメタデータまたは証明書をダウンロードするには、次の手順に従います。

1.  [**Azure Portal**](https://portal.azure.com/) を開き、**グローバル管理者**または**共同管理者**としてサインインします。

2.  左側のメイン ナビゲーション メニューの上部にある **[すべてのサービス]** をクリックして **[Azure Active Directory 拡張機能]** を開きます。

3.  フィルター検索ボックスに「**Azure Active Directory**」と入力し、**[Azure Active Directory]** 項目を選択します。

4.  Azure Active Directory の左側のナビゲーション メニューから **[エンタープライズ アプリケーション]** をクリックします。

5.  **[すべてのアプリケーション]** をクリックして、すべてのアプリケーションの一覧を表示します。

   * ここに表示したいアプリケーションが表示されない場合は、**[All Applications List (すべてのアプリケーション リスト)]** の上部にある **[フィルター]** コントロールを使用して、**[表示]** オプションを **[すべてのアプリケーション]** に設定します。

6.  シングル サインオンを構成したアプリケーションを選択します。

7.  アプリケーションが読み込まれたら、アプリケーションの左側のナビゲーション メニューから **[シングル サインオン]** をクリックします。

8.  **[SAML 署名証明書]** セクションに移動して、**[ダウンロード]** 列の値をクリックします。 アプリケーションでシングル サインオンを構成するために何が必要かに応じて、メタデータ XML または証明書をダウンロードするオプションが表示されます。

Azure AD では、メタデータを取得するための URL も提供されます。 https://login.microsoftonline.com/<Directory ID>/federationmetadata/2007-06/federationmetadata.xml?appid=<Application ID> というパターンに従って、アプリケーション固有のメタデータ URL を取得します。

## <a name="assign-users-to-the-application"></a>アプリケーションにユーザーを割り当てる

1 人以上のユーザーをアプリケーションに直接割り当てるには、次の手順に従います。

1.  [**Azure Portal**](https://portal.azure.com/) を開き、**グローバル管理者**としてサインインします。

2.  左側のメイン ナビゲーション メニューの上部にある **[すべてのサービス]** をクリックして **[Azure Active Directory 拡張機能]** を開きます。

3.  フィルター検索ボックスに「**Azure Active Directory**」と入力し、**[Azure Active Directory]** 項目を選択します。

4.  Azure Active Directory の左側のナビゲーション メニューから **[エンタープライズ アプリケーション]** をクリックします。

5.  **[すべてのアプリケーション]** をクリックして、すべてのアプリケーションの一覧を表示します。

  * ここに表示したいアプリケーションが表示されない場合は、**[All Applications List (すべてのアプリケーション リスト)]** の上部にある **[フィルター]** コントロールを使用して、**[表示]** オプションを **[すべてのアプリケーション]** に設定します。

6.  ユーザーを割り当てるアプリケーションを一覧から選びます。

7.  アプリケーションが読み込まれたら、アプリケーションの左側のナビゲーション メニューから **[ユーザーとグループ]** をクリックします。

8.  **[ユーザーとグループ]** 一覧の上部にある **[追加]** ボタンをクリックして、**[割り当ての追加]** ウィンドウを開きます。

9.  **[割り当ての追加]** ウィンドウから **[ユーザーとグループ]** セレクターをクリックします。

10. 割り当てる対象のユーザーの**フル ネーム**または**電子メール アドレス**を **[名前または電子メール アドレスで検索]** 検索ボックスに入力します。

11. リスト内で**ユーザー**にポインターを合わせ、**チェック ボックス**を表示します。 ユーザーのプロファイル写真またはロゴの横にあるチェック ボックスをオンにして、ユーザーを **[選択済み]** リストに追加します。

12. **省略可能:** **複数のユーザーを追加**する場合は、別の**フル ネーム**または**電子メール アドレス**を **[名前または電子メール アドレスで検索]** 検索ボックスに入力し、チェック ボックスをオンにして **[選択済み]** リストにこのユーザーを追加します。

13. ユーザーの選択が完了したら、**[選択]** ボタンをクリックして、アプリケーションに割り当てるユーザーとグループの一覧に追加します。

14. **省略可能:** **[割り当ての追加]** ウィンドウで **[ロールの選択]** セレクターをクリックして、選択したユーザーに割り当てるロールを選択します。

15. **[割り当て]** ボタンをクリックして、選択したユーザーにアプリケーションを割り当てます。

少し待つと、選択したユーザーは、ソリューションの説明セクションで説明されている方法を使用してこれらのアプリケーションを起動できるようになります。

## <a name="customizing-the-saml-claims-sent-to-an-application"></a>アプリケーションに送信される SAML 要求をカスタマイズする

アプリケーションに送信される SAML 属性要求をカスタマイズする方法については、「[Azure Active Directory での要求マッピング](https://docs.microsoft.com/azure/active-directory/active-directory-claims-mapping)」をご覧ください。

## <a name="next-steps"></a>次の手順
[アプリケーション プロキシを使用してアプリにシングル サインオンを提供](manage-apps/application-proxy-configure-single-sign-on-with-kcd.md)
