---
title: Azure Storage アカウントの種類 | Microsoft Docs
description: Azure Storage の種類と選択について説明します。
services: storage
author: xyh1
ms.service: storage
ms.topic: get-started-article
ms.date: 07/14/2018
ms.author: hux
ms.component: common
ms.openlocfilehash: ff1d4e61b21eb4ffbfb5e43a66acb2a5a1fbf16f
ms.sourcegitcommit: 9819e9782be4a943534829d5b77cf60dea4290a2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/06/2018
ms.locfileid: "39526604"
---
# <a name="azure-storage-account-options"></a>Azure Storage アカウントの種類

## <a name="overview"></a>概要
Azure Storage は、3 種類のアカウントから選択できるようになっています。3 つのアカウントはそれぞれ料金体系が異なり、サポートされている機能も異なります。 アプリケーションに最適な種類を判断するために、ストレージ アカウントを作成する前にこれらの違いを考慮してください。 その 3 つのストレージ アカウントの種類を次に示します。

* [**汎用 v2 (GPv2)** アカウント](#general-purpose-v2-accounts)
* [**汎用 v1 (GPv1)** アカウント](#general-purpose-v1-accounts)
* [**BLOB ストレージ** アカウント](#blob-storage-accounts)

次のセクションでは、各種アカウントについて詳しく説明します。

## <a name="storage-account-options"></a>ストレージ アカウントのオプション

### <a name="general-purpose-v2-accounts"></a>汎用 v2 アカウント

汎用 v2 (GPv2) アカウントは、BLOB、ファイル、キュー、テーブルの最新機能すべてをサポートするストレージ アカウントです。 GPv2 アカウントは、汎用 v1 (GPv1) アカウントと BLOB ストレージ アカウントでサポートされているすべての API、サービス、機能をサポートします。 さらに、すべてのストレージ アカウントの種類で提供される同じ持続性、可用性、スケーラビリティ、パフォーマンスを保持します。 GPv2 アカウントの料金体系は、GB 単価の最安値と業界的に競争力の高いトランザクション料金の実現を目指して設定されています。

GPv1 または BLOB ストレージ アカウントは、Azure Portal、PowerShell、または Azure CLI を使用して GPv2 アカウントにアップグレードできます。 

GPv2 ストレージ アカウントのブロック BLOB では、使用パターンに基づいて、アカウント レベルでホット ストレージ アクセス層とクール ストレージ アクセス層のいずれかを選択できるほか、BLOB レベルでホット アクセス層、クール アクセス層、アーカイブ アクセス層のいずれかを選択できます。 頻繁にアクセスするデータ、アクセス頻度の低いデータ、ほとんどアクセスしないデータのそれぞれを、ホット、クール、アーカイブの各ストレージ層に格納して、ストレージ コストとトランザクション コストを最適化します。 

GPv2 ストレージ アカウントは、**アクセス層**属性をアカウント レベルで公開しており、この属性で、既定のストレージ アカウント層を**ホット**または**クール**として指定できます。 既定のストレージ アカウント層は、BLOB レベルで層が明示的に設定されていない BLOB に適用されます。 データの使用パターンが変化した場合は、いつでもこれらのストレージ層を切り替えることができます。 **アーカイブ**層は、BLOB レベルでのみ適用できます。

> [!NOTE]
> ストレージ層を変更すると、追加料金が発生することがあります。 詳細については、「[価格と課金](#pricing-and-billing)」セクションを参照してください。
>
> Microsoft では、ほとんどのシナリオについて BLOB ストレージ アカウントよりも汎用 v2 ストレージ アカウントを使用することをお勧めします。

### <a name="upgrade-a-storage-account-to-gpv2"></a>GPv2 へのストレージ アカウントのアップグレード

ユーザーは、いつでも Azure portal、PowerShell、または Azure CLI を使用して GPv1 または BLOB ストレージ アカウントを GPv2 アカウントにアップグレードすることができます。 この変更は元に戻せません。また、これ以外のアカウント種類変更は許可されません。 既存のストレージ アカウントの評価については、「[GPv2 ストレージ アカウントの評価と移行](#evaluating-and-migrating-to-gpv2-storage-accounts)」セクションを参照してください。
* [Azure portal を使用した GPv2 へのアップグレード](#upgrade-with-azure-portal)
* [PowerShell を使用した GPv2 へのアップグレード](#upgrade-with-powershell)
* [Azure CLI を使用した GPv2 へのアップグレード](#upgrade-with-azure-cli)

#### <a name="upgrade-with-azure-portal"></a>Azure portal を使用したアップグレード
Azure portal を使用して GPv1 または BLOB ストレージ アカウントを GPv2 アカウントにアップグレードするには、まず [Azure portal](https://portal.azure.com) にサインインし、ストレージ アカウントを選択します。 **[設定]** > **[構成]** を選択します。 アップグレード プロセスに関するメモと共に、**[アップグレード]** ボタンが表示されます。

#### <a name="upgrade-with-powershell"></a>PowerShell を使用したアップグレード

PowerShell を使用して GPv1 または BLOB ストレージ アカウントを GPv2 アカウントをアップグレードするには、まず、**AzureRm.Storage** モジュールの最新バージョンを使用するために PowerShell を更新します。 PowerShell のインストールについては、「[Azure PowerShell のインストールおよび構成](https://docs.microsoft.com/powershell/azure/install-azurerm-ps)」を参照してください。 その後、次のコマンドを呼び出してアカウントをアップグレードします。その際、目的のリソース グループおよびストレージの名前に置き換えます。

```powershell
Set-AzureRmStorageAccount -ResourceGroupName <resource-group> -AccountName <storage-account> -UpgradeToStorageV2
```

#### <a name="upgrade-with-azure-cli"></a>Azure CLI を使用したアップグレード

Azure CLI を使用して GPv1 または BLOB ストレージ アカウントを GPv2 アカウントをアップグレードするには、最初に、Azure CLI の最新バージョンをインストールします。 CLI のインストールについては、[Azure CLI 2.0 のインストール](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest)に関するページを参照してください。 その後、次のコマンドを呼び出してアカウントをアップグレードします。その際、目的のリソース グループおよびストレージの名前に置き換えます。

```cli
az storage account update -g <resource-group> -n <storage-account> --set kind=StorageV2
```` 

### <a name="general-purpose-v1-accounts"></a>汎用 v1 アカウント

汎用 v1 (GPv1) アカウントでは、すべての Azure Storage サービスにアクセスできますが、最新の機能が利用できない場合があるほか、GB 単価もやや高いことがあります。 たとえば、GPv1 では、クール ストレージとアーカイブ ストレージがサポートされません。 この種類のアカウントは、GPv1 トランザクションの料金が比較的低いため、変更頻度が高いワークロードや読み取り速度が速いワークロードでメリットが得られることがあります。

汎用 v1 (GPv1) ストレージ アカウントは最も古い種類のストレージ アカウントであり、クラシック デプロイ モデルで唯一使用することができます。 

### <a name="blob-storage-accounts"></a>BLOB ストレージ アカウント

BLOB ストレージ アカウントは、GPv2 とまったく同じブロック BLOB 機能を備えていますが、サポートされるのはブロック BLOB だけです。 価格については、汎用 v2 アカウントと大きな違いはありません。 BLOB ストレージ アカウントと GPv2 の価格の違いをよく確認したうえで、GPv2 へのアップグレードを検討してください。 このアップグレードは元に戻すことができません。

> [!NOTE]
> BLOB ストレージ アカウントは、ブロック BLOB と追加 BLOB のみをサポートします。ページ BLOB はサポートしません。
>
> Microsoft では、ほとんどのシナリオについて BLOB ストレージ アカウントよりも汎用 v2 ストレージ アカウントを使用することをお勧めします。

## <a name="recommendations"></a>Recommendations

ストレージ アカウントの詳細については、「[Azure ストレージ アカウントについて](../common/storage-create-storage-account.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)」を参照してください。

最新のブロックまたは追加 BLOB 機能を必要とするアプリケーションでは、階層化されたストレージの分化された料金モデルを利用するために、GPv2 ストレージ アカウントを使用することをお勧めします。 ただし、次のような特定のシナリオでは GPv1 を使用することがあります。

* まだクラシック デプロイ モデルを使用する必要がある。 GPv2 および BLOB ストレージ アカウントは、Azure Resource Manager デプロイ モデルだけで利用できます。
* 大量のトランザクションまたは geo レプリケーション帯域幅を使用している。どちらも GPv2 ストレージ アカウントと BLOB ストレージ アカウントの方が GPv1 よりもコストが割高となり、低い GB 単価の利点が活かせるだけの十分なストレージを確保できません。
* [Storage Services REST API](https://msdn.microsoft.com/library/azure/dd894041.aspx) の 2014-02-14 より前のバージョンか、クライアント ライブラリの 4.x より前のバージョンを使用していて、アプリケーションをアップグレードできない。

## <a name="pricing-and-billing"></a>価格と課金
すべてのストレージ アカウントでは、各 BLOB の層に基づいた Blob Storage の価格モデルを採用しています。 ストレージ アカウントを使用するときには、課金に関して次の点を考慮してください。

* **ストレージ コスト**: データの格納のコストは、格納されているデータの量だけでなく、ストレージ層にも左右されます。 よりクールな層になるほど、ギガバイトあたりのコストが下がります。
* **データ アクセス コスト**: データ アクセス料金は、よりクールな層になるほど高くなります。 クールおよびアーカイブ ストレージ層のデータの場合、読み取りに対して、ギガバイト単位のデータ アクセス料金が課金されます。
* **トランザクション コスト**: すべての層に対してトランザクションごとに課金されます。よりクールな層になるほどコストが高くなります。
* **geo レプリケーション データ転送コスト**: GRS と RA-GRS を含む geo レプリケーションが構成されているアカウントだけに適用されます。 geo レプリケーション データ転送には、ギガバイトあたりの料金がかかります。
* **送信データ転送コスト**: 送信データ転送 (Azure リージョン外に転送されるデータ) では、帯域幅使用量に対する課金がギガバイトあたりで発生します。これは、汎用ストレージ アカウントと同じです。
* **ストレージ層の変更**: アカウント ストレージ層をクールからホットに変更すると、ストレージ アカウントに存在するすべてのデータの読み取りと同等の課金が発生します。 ただし、アカウント ストレージ層をホットからクールに変更したときは、クール層への全データの書き込みに相当する課金が発生します (GPv2 アカウントのみ)。

> [!NOTE]
> ストレージ アカウントの価格モデルの詳細については、[Azure Storage の価格](https://azure.microsoft.com/pricing/details/storage/)に関するページを参照してください。 送信データ転送の価格の詳細については、[データ転送の料金詳細](https://azure.microsoft.com/pricing/details/data-transfers/)に関するページを参照してください。

## <a name="quickstart-scenarios"></a>クイックスタート シナリオ

このセクションでは、Azure Portal を使用して、次のシナリオについて説明します。

* [GPv2 ストレージ アカウントを作成する方法。](#create-a-gpv2-storage-account-using-the-azure-portal)
* [GPv1 または BLOB ストレージ アカウントを GPv2 ストレージ アカウントに変換する方法。](#convert-a-gpv1-or-blob-storage-account-to-a-gpv2-storage-account-using-the-azure-portal)
* [GPv2 または BLOB ストレージ アカウントのアカウント層を設定する方法。](#change-the-storage-tier-of-a-gpv2-storage-account-using-the-azure-portal)
* [GPv2 または BLOB ストレージ アカウントの BLOB 層を設定する方法。](#change-the-storage-tier-of-a-blob-using-the-azure-portal)

以下の例では、設定がストレージ アカウント全体に適用されるため、アクセス層をアーカイブに設定することはできません。 アーカイブは、特定の BLOB に対してのみ設定できます。

### <a name="create-a-gpv2-storage-account-using-the-azure-portal"></a>Azure Portal を使用して GPv2 ストレージ アカウントを作成する

1. [Azure Portal](https://portal.azure.com) にサインインします。

2. ハブ メニューで、**[リソースの作成]** > **[データ + ストレージ]** > **[ストレージ アカウント]** を選択します。

3. ストレージ アカウントの名前を入力します。

    この名前は、グローバルに一意である必要があります。この名前は、ストレージ アカウントのオブジェクトにアクセスするための URL の一部として使用されます。  

4. デプロイ モデルとして **[Resource Manager]** を選択します。

    階層型ストレージは、Resource Manager ストレージ アカウントでのみ使用できます。Resource Manager は、新しいリソースに推奨されるデプロイメント モデルです。 詳細については、「[Azure Resource Manager の概要](../../azure-resource-manager/resource-group-overview.md)」を参照してください。  

5. **[アカウントの種類]** ボックスの一覧の **[General Purpose v2]\(汎用 v2\)** を選択します。

    GPv2 を選択すると、パフォーマンス レベルが Standard に設定されます。 階層型ストレージは、Premium パフォーマンス レベルでは利用できません。

6. ストレージ アカウントのレプリケーション オプション (**[LRS]****[ZRS]**、**[GRS]**、または **[RA-GRS]**) を選択します。 既定値は **[RA-GRS]** です。

    LRS はローカル冗長ストレージ、ZRS はゾーン冗長ストレージ、GRS は geo 冗長ストレージ (2 つのリージョン)、RA-GRS は読み取りアクセス geo 冗長ストレージ (2 つのリージョン。セカンダリに対する読み取りアクセス権が付与される) です。

    Azure Storage のレプリケーション オプションの詳細については、 [Azure Storage のレプリケーション](../common/storage-redundancy.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)に関するページをご覧ください。

7. ニーズに応じた適切なストレージ層を選択します。**[アクセス レベル]** を **[クール]** と **[ホット]** のいずれかに設定します。 既定値は **[ホット]** です。

8. 新しいストレージ アカウントを作成するサブスクリプションを選択します。

9. 新しいリソース グループを指定するか、既定のリソース グループを選択します。 リソース グループの詳細については、「[Azure Resource Manager の概要](../../azure-resource-manager/resource-group-overview.md)」をご覧ください。

10. ストレージ アカウントのリージョンを選択します。

11. **[作成]** をクリックしてストレージ アカウントを作成します。

### <a name="convert-a-gpv1-or-blob-storage-account-to-a-gpv2-storage-account-using-the-azure-portal"></a>Azure Portal を使用して GPv1 または BLOB ストレージ アカウントを GPv2 ストレージ アカウントに変換する

1. [Azure Portal](https://portal.azure.com) にサインインします。

2. ストレージ アカウントに移動するには、**[すべてのリソース]** を選択し、ストレージ アカウントを選択します。

3. [設定] セクションで **[構成]** をクリックします。

4. **[アカウントの種類]** の **[アップグレード]** をクリックします。

5. **[アップグレードの確認]** で、アカウントの名前を入力します。 

5. ブレードの下部にある [アップグレード] をクリックします。

### <a name="change-the-storage-tier-of-a-gpv2-storage-account-using-the-azure-portal"></a>Azure Portal を使用して GPv2 ストレージ アカウントのストレージ層を変更する

1. [Azure Portal](https://portal.azure.com) にサインインします。

2. ストレージ アカウントに移動するには、**[すべてのリソース]** を選択し、ストレージ アカウントを選択します。

3. [設定] ブレードで **[構成]** をクリックし、アカウント構成を表示または変更します。

4. ニーズに応じた適切なストレージ層を選択します。**[アクセス レベル]** を **[クール]** と **[ホット]** のいずれかに設定します。

5. ブレードの上部にある [保存] をクリックします。

### <a name="change-the-storage-tier-of-a-blob-using-the-azure-portal"></a>Azure Portal を使用した BLOB のストレージ層の変更

1. [Azure Portal](https://portal.azure.com) にサインインします。

2. ストレージ アカウントの BLOB に移動するには、**[すべてのリソース]**、ストレージ アカウント、コンテナー、BLOB を順に選択します。

3. BLOB のプロパティ ブレードで、**[アクセス レベル]** ドロップダウン メニューをクリックし、**[ホット]**、**[クール]**、または **[アーカイブ]** ストレージ層を選択します。

5. ブレードの上部にある [保存] をクリックします。

> [!NOTE]
> ストレージ層を変更すると、追加料金が発生することがあります。 詳細については、「[価格と課金](#pricing-and-billing)」セクションを参照してください。


## <a name="evaluating-and-migrating-to-gpv2-storage-accounts"></a>GPv2 ストレージ アカウントの評価と移行
このセクションの目的は、ご使用のストレージ アカウントを GPv1 ストレージ アカウントから GPv2 ストレージ アカウントにスムーズに移行できるよう支援することです。 2 つのユーザー シナリオがあります。

* GPv1 ストレージ アカウントを既に持っており、適切なストレージ層の GPv2 ストレージ アカウントへの変更を評価したい。
* GPv2 ストレージ アカウントの使用を決定しているか、既に所有しており、ホット ストレージ層とクール ストレージ層のどちらを使用すべきかを評価したい。

いずれの場合も、最初にすべきことは、GPv2 ストレージ アカウントに格納されるデータの格納、アクセス、操作にかかるコストを見積もり、そのコストを現在のコストと比較することです。

## <a name="evaluating-gpv2-storage-account-tiers"></a>GPv2 ストレージ アカウント層の評価

GPv2 ストレージ アカウントに保存されるデータの格納とアクセスにかかるコストを見積もるためには、既存の使用パターンを評価するか、予想される使用パターンを概算する必要があります。 一般に、以下のことを調べる必要があります。

* データ ストレージ消費量 (GB)
    - ストレージ アカウントに格納されているデータの量はどれくらいか。
    - 月単位でデータ ボリュームがどのように変化するか。古いデータが定期的に新しいデータに置き換わるかどうか。
* ストレージ アクセス パターン (操作とデータ転送)
    - ストレージ アカウントから読み取られている (エグレス) データの量とストレージ アカウントに書き込まれている (イングレス) データの量はどれくらいか。 
    - ストレージ アカウント内のデータに対して実行される操作の回数はどれくらいか。
    - データに対してどのような操作 (読み取りと書き込み) が行われているか。

## <a name="monitoring-existing-storage-accounts"></a>既存のストレージ アカウントの監視

既存のストレージ アカウントを監視し、そのデータを収集するには、Azure Storage Analytics を利用できます。これにより、ログ記録が実行され、ストレージ アカウントのメトリック データが得られます。 Storage Analytics では、GPv1、GPv2、BLOB というストレージ アカウントの種類について、ストレージ サービスへの要求に関して集計されたトランザクション統計情報と容量データを含むメトリックを格納できます。 このデータは、同じストレージ アカウント内の既知のテーブルに格納されます。

詳細については、「[About Storage Analytics Metrics (Storage Analytics メトリックについて)](https://msdn.microsoft.com/library/azure/hh343258.aspx)」と「[Storage Analytics Metrics Table Schema (Storage Analytics メトリックのテーブル スキーマ)](https://msdn.microsoft.com/library/azure/hh343264.aspx)」を参照してください。

> [!NOTE]
> BLOB ストレージ アカウントは、そのアカウントのメトリック データの格納とアクセスのためだけに Table service エンドポイントを公開します。 

BLOB ストレージのストレージ使用量を監視するには、容量メトリックを有効にする必要があります。
これを有効にすると、ストレージ アカウントの Blob service に関する容量データが毎日記録されます。これは、同じストレージ アカウント内の *$MetricsCapacityBlob* テーブルに書き込まれるテーブル エントリとして記録されます。

BLOB ストレージのデータ アクセス パターンを監視するには、API から時間単位のトランザクション メトリックを有効にする必要があります。 時間単位のトランザクション メトリックを有効にすると、API あたりのトランザクションが 1 時間ごとに集計され、同じストレージ アカウント内の *$MetricsHourPrimaryTransactionsBlob* テーブルに書き込まれるテーブル エントリとして記録されます。 *$MetricsHourSecondaryTransactionsBlob* テーブルには、RA-GRS ストレージ アカウントを使用している場合のセカンダリ エンドポイントに対するトランザクションが記録されます。

> [!NOTE]
> 汎用ストレージ アカウントがあり、そのアカウントに、ページ BLOB と仮想マシン ディスク (またはキュー、ファイル、テーブルのいずれか) を、ブロック BLOB データと追加 BLOB データと共に格納している場合、この見積もりプロセスは適用できません。 容量データにおいて、ブロック BLOB と他の種類が区別されず、他の種類のデータに関する容量データが得られません。 これらのタイプを使用する場合、直近の請求書に記載された数量に着目することで対応することもできます。

データ使用量とアクセス パターンを正確に見積もるには、通常の使用状況を表すメトリックの保有期間を選択したうえで推定することをお勧めします。 その方法の 1 つとして、メトリック データを 7 日間保持し、そのデータを毎週収集して、月末に分析を行う方法があります。 そのほかに、過去 30 日間のメトリック データを保持し、30 日の期間の最後にそのデータを収集、分析する方法もあります。

メトリック データの有効化、収集、表示の詳細については、「[Azure のストレージ メトリックの有効化とメトリック データの表示](../common/storage-enable-and-view-metrics.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)」を参照してください。

> [!NOTE]
> 分析データの格納、アクセス、ダウンロードについても、通常のユーザー データと同様に課金されます。

### <a name="utilizing-usage-metrics-to-estimate-costs"></a>コストを見積もるための使用状況メトリックの利用

#### <a name="storage-costs"></a>ストレージ コスト

行キー *"data"* がある容量メトリック テーブル *$MetricsCapacityBlob* の最新のエントリは、ユーザー データによって使用されたストレージ容量を示します。 行キー *"analytics"* がある容量メトリック テーブル *$MetricsCapacityBlob* の最新のエントリは、分析ログによって使用されたストレージ容量を示します。

ユーザー データと分析ログ (有効な場合) の両方によって使用されたこの合計容量は、ストレージ アカウントにデータを格納するコストを見積もるために使用できます。 また、同じ方法を使用して、GPv1 ストレージ アカウントでのストレージ コストを見積もることができます。

#### <a name="transaction-costs"></a>トランザクション コスト

*"TotalBillableRequests"* の合計は、トランザクション メトリック テーブル内の API のすべてのエントリを対象とし、その特定の API のトランザクションの総数を示すものです。 "*たとえば*"、特定期間の "*GetBlob*" トランザクションの合計は、行キー "*user;GetBlob*" を備えたすべてのエントリに対する課金対象の要求をすべて加算することによって計算できます。

BLOB ストレージ アカウントのトランザクション コストを見積もるには、トランザクションを 3 つのグループに分類する必要があります (それぞれ価格が異なるため)。

* *"PutBlob"*、*"PutBlock"*、*"PutBlockList"*、*"AppendBlock"*、*"ListBlobs"*、*"ListContainers"*、*"CreateContainer"*、*"SnapshotBlob"*、*"CopyBlob"* などの書き込みトランザクション。
* *"GetBlob"* などの読み取りトランザクション。
* その他すべてのトランザクション。

GPv1 ストレージ アカウントのトランザクション コストを見積もるには、操作と API に関係なく、すべてのトランザクションを集計する必要があります。

### <a name="data-access-and-geo-replication-data-transfer-costs"></a>データ アクセスと geo レプリケーション データ転送のコスト

Storage Analytics では、ストレージ アカウントに対する読み取りと書き込みのデータ量は示されませんが、トランザクション メトリック テーブルを確認することで大まかに見積もることは可能です。 トランザクション メトリック テーブル内の API の全エントリを対象とした *"TotalIngress"* の合計は、その特定の API の受信データの総量をバイトで示すものです。 同様に、 *"TotalEgress"* の合計は、送信データの総量をバイトで示します。

BLOB ストレージ アカウントのデータ アクセス コストを見積もるには、トランザクションを 2 つのグループに分類する必要があります。

* ストレージ アカウントから取得されたデータの量は、主に *"GetBlob"* 操作と *"CopyBlob"* 操作の *"TotalEgress"* の合計を確認することで見積もることができます。
* ストレージ アカウントに書き込まれたデータの量は、主に *"PutBlob"* 操作、*"PutBlock"* 操作、*"CopyBlob"* 操作、*"AppendBlock"* 操作の *"TotalIngress"* の合計を確認することで見積もることができます。

また、BLOB ストレージ アカウントの geo レプリケーション データ転送のコストは、GRS ストレージ アカウントまたは RA-GRS ストレージ アカウントを使用する場合に書き込まれるデータ量の見積もりを使用することによって計算することもできます。

> [!NOTE]
> ホット ストレージ層またはクール ストレージ層を使用する場合のコストの計算に関する詳細な例については、「*Azure Storage Pricing* 」というページにある、 ["ホットおよびクール アクセス層とはどのようなものですか? また、どちらを使用すればよいのでしょうか?"](https://azure.microsoft.com/pricing/details/storage/)にサインインします。

## <a name="migrating-existing-data"></a>既存のデータの移行

GPv1 または BLOB ストレージ アカウントは、GPv2 に簡単にアップグレードできます。ダウンタイムや API の変更は不要で、データの移行も必要ありません。 このため、GPv1 アカウントを BLOB ストレージ アカウントではなく GPv2 アカウントを移行することを強くお勧めします。 GPv2 へのアップグレードの詳細については、「[GPv2 へのストレージ アカウントのアップグレード](#upgrade-a-storage-account-to-gpv2)」を参照してください。

それでも GPv1 から BLOB ストレージ アカウントに移行する必要があり、GPv2 アカウントを使用できない場合は、次の手順に従ってください。 

BLOB ストレージ アカウントは、ブロック BLOB と追加 BLOB の格納に特化しています。 テーブル、キュー、ファイル、ディスク、および BLOB を格納できる既存の汎用ストレージ アカウントは、BLOB ストレージ アカウントに変換することはできません。 つまり、ストレージ層を使用するには、新しい BLOB ストレージ アカウントを作成し、既存のデータを新たに作成したアカウントに移行する必要があります。 

オンプレミス ストレージ デバイス、サード パーティのクラウド ストレージ プロバイダー、または Azure の既存の汎用ストレージ アカウントから、既存のデータを BLOB ストレージ アカウントに移行するには、以下の方法を使用できます。

### <a name="azcopy"></a>AzCopy

AzCopy は、Azure Storage との間で高パフォーマンスのデータ コピーを行うように設計された Windows コマンドライン ユーティリティです。 AzCopy を使用して、既存の汎用ストレージ アカウントから BLOB ストレージ アカウントにデータをコピーできます。またオンプレミス ストレージ デバイスから BLOB ストレージ アカウントにデータをアップロードすることもできます。

詳細については、[AzCopy コマンド ライン ユーティリティを使用したデータの転送](../common/storage-use-azcopy.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)に関するページをご覧ください。

### <a name="data-movement-library"></a>データ移動ライブラリ

Azure Storage Data Movement Library for .Net は、AzCopy を動作させているコア データ移動フレームワークに基づいています。 ライブラリは、AzCopy と同じように、高パフォーマンスで信頼性が高く簡単なデータ転送操作ができるように設計されています。 これを使用すると、AzCopy で提供される機能をアプリケーションでネイティブに活用できます。その際、AzCopy の外部インスタンスを実行したり監視したりする必要はありません。

詳細については、[Azure Storage Data Movement Library for .Net](https://github.com/Azure/azure-storage-net-data-movement) に関するページを参照してください。

### <a name="rest-api-or-client-library"></a>REST API またはクライアント ライブラリ

Azure クライアント ライブラリのいずれかまたは Azure ストレージ サービス REST API を使用して、データを BLOB ストレージ アカウントに移行するためのカスタム アプリケーションを作成することができます。 Azure Storage には、.NET、Java、C++、Node.js、PHP、Ruby、Python などの複数の言語とプラットフォーム用の豊富なクライアント ライブラリが用意されています。 クライアント ライブラリは、再試行ロジック、ログ、並列アップロードといった高度な機能を提供します。 また、REST API を直接使用して開発することもでき、HTTP/HTTPS 要求を行うどの言語からでも呼び出すことができます。

詳細については、[Azure Blob Storage の使用](../blobs/storage-dotnet-how-to-use-blobs.md)に関するページを参照してください。

> [!IMPORTANT]
> クライアント側の暗号化を使用して暗号化された BLOB には、BLOB と共に暗号化関連メタデータが格納されます。 クライアント側の暗号化で暗号化された BLOB をコピーする場合は、コピー操作の際に BLOB メタデータ、特に暗号化関連のメタデータが保持されるようにしてください。 暗号化メタデータなしで BLOB をコピーした場合、BLOB コンテンツを再度取得することはできません。 暗号化関連メタデータの詳細については、[Azure Storage のクライアント側の暗号化](../common/storage-client-side-encryption.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)に関するページを参照してください。

## <a name="faq"></a>FAQ

**既存のストレージ アカウントを引き続き使用できますか。**

はい。既存のストレージ アカウント (GPv1) はまだ使用可能であり、料金や機能も変更されていません。 GPv1 アカウントにはストレージ層を選択する機能がなく、今後も階層化機能は導入されません。

**GPv2 ストレージ アカウントは、いつ、どのようなときに使用し始めればよいですか。**

GPv2 ストレージ アカウントは、GB 単価の最安値を提供しつつ、業界的に競争力の高いトランザクション コストとデータ アクセス コストを実現することに特化されています。 今後、変更通知をはじめとする新たな機能は GPv2 ストレージ アカウントに基づいて導入されるため、BLOB の格納にも、GPv2 タイプのアカウントが推奨されます。 ただし、いつアップグレードするかは、ビジネス要件に応じてお客様が判断する必要があります。 たとえば、アップグレードよりもまず、トランザクション パターンを最適化するという選択肢も考えられます。

GPv2 からのダウングレードはサポートされていないため、アカウントを GPv2 にアップグレードする前に、料金に関するすべての影響を考慮してください。

**既存のストレージ アカウントを GPv2 ストレージ アカウントにアップグレードできますか。**

はい。 GPv1 または BLOB ストレージ アカウントは、ポータルで、または PowerShell か CLI を使用して、簡単に GPv2 にアップグレードすることができます。 

GPv2 からのダウングレードはサポートされていないため、アカウントを GPv2 にアップグレードする前に、料金に関するすべての影響を考慮してください。

**同じアカウントの両方のストレージ層にオブジェクトを格納することはできますか。**

はい。 アカウント レベルで設定された**アクセス層**属性は、明示的に層が設定されていない、そのアカウント内のすべてのオブジェクトに適用される既定の層です。 ただし、BLOB レベルの階層制御では、アカウントで設定されているアクセス層に関係なく、オブジェクト レベルでアクセス層を設定できます。 3 つのストレージ層 (ホット、クール、またはアーカイブ) のいずれの BLOB も同じアカウント内に存在することができます。

**自分の GPv2 ストレージ アカウントのストレージ層を変更することはできますか。**

はい。ストレージ アカウントの**アクセス層**属性を設定することで、アカウントのストレージ層を変更することができます。 アカウントのストレージ層の変更は、アカウントに格納されている、層が明示的に設定されていないすべてのオブジェクトに適用されます。 ストレージ層をホットからクールに変更すると、書き込み操作 (10,000 件単位) の料金が発生します (GPv2 ストレージ アカウントのみ)。一方、クールからホットに変更すると、アカウント内のすべてのデータの読み取りに対し、読み取り操作 (10,000 件単位) とデータ取得 (GB 単位) の両方の料金が発生します。

**自分の GPv2 または BLOB ストレージ アカウントのストレージ層は、どの程度の頻度で変更できますか。**

ストレージ層の変更頻度に対して制限は設けられていませんが、ストレージ層をクールからホットに変更すると、かなりの料金が発生する可能性があることに注意してください。 ストレージ層を頻繁に変更することは、お勧めしません。

**クール ストレージ層内の BLOB の動作は、ホット ストレージ層内の BLOB とは異なりますか。**

GPv2 ストレージ アカウントと BLOB ストレージ アカウントのホット ストレージ層に存在する BLOB の待ち時間は、GPv1 ストレージ アカウントの BLOB と同じになります。 クール ストレージ層内の BLOB の待ち時間は、ホット ストレージ層の BLOB と類似しています (ミリ秒)。 アーカイブ ストレージ層の BLOB の待ち時間は数時間に及びます。

クール ストレージ層内の BLOB は、ホット ストレージ層に格納された BLOB よりも可用性サービス レベル (SLA) が若干低くなります。 詳細については、「[Storage の SLA](https://azure.microsoft.com/support/legal/sla/storage)」を参照してください。

**BLOB ストレージ アカウントにページ BLOB と仮想マシンのディスクを保存できますか。**

いいえ。 BLOB ストレージ アカウントは、ブロック BLOB と追加 BLOB のみをサポートします。ページ BLOB はサポートしません。 Azure の仮想マシンのディスクではページ BLOB が使用されるため、BLOB ストレージ アカウントは仮想マシンのディスクの格納に使用できません。 ただし、仮想マシンのディスクのバックアップを BLOB ストレージ アカウント内にブロック BLOB として格納することはできます。 これは、BLOB ストレージ アカウントではなく GPv2 の使用が検討される理由の 1 つです。

**GPv2 ストレージ アカウントのページ BLOB を階層化できますか。**

いいえ。 ページ BLOB はアカウントのストレージ層を推測しますが、価格や可用性には影響を与えません。 ページ BLOB のアクセス層をホット、クール、またはアーカイブに変更することはできません。 プレミアム ストレージ アカウント内のページ BLOB では BLOB 層の設定操作が許可されていますが、プレミアム ページ BLOB の許可されたサイズ、IOPS、帯域幅のみを決定します。 詳細については、「[Set Blob Tier](https://docs.microsoft.com/en-us/rest/api/storageservices/set-blob-tier)」(BLOB 層を設定する) を参照してください。

**GPv2 ストレージ アカウントを使用するには、既存のアプリケーションを変更する必要がありますか。**

GPv2 ストレージ アカウントは、GPv1 ストレージ アカウントおよび BLOB ストレージ アカウントとの間で、100% の API 整合性を備えています。 アプリケーションでブロック BLOB または追加 BLOB が使用されており、[Storage Services REST API](https://msdn.microsoft.com/library/azure/dd894041.aspx) の 2014-02-14 バージョン以降を使用している限り、アプリケーションは機能します。 プロトコルの古いバージョンを使用している場合は、新しいバージョンを使用して両方の種類のストレージ アカウントとシームレスに動作するように、アプリケーションを更新する必要があります。 一般に、どの種類のストレージ アカウントを使用するかにかかわらず、常に最新バージョンを使用することをお勧めしています。

GPv2 の料金は、通常、トランザクションと帯域幅に対して GPv1 よりも高くなります。 そのため、アップグレードする前に、請求の合計額が増加しないようにトランザクション パターンを最適化しなければならない場合があります。

**ユーザー エクスペリエンスに変更はありますか。**

GPv2 ストレージ アカウントは GPv1 ストレージ アカウントとよく似ており、高い持続性、可用性、スケーラビリティ、パフォーマンス、セキュリティなどの Azure Storage のすべての主要機能をサポートしています。 GPv2 または BLOB ストレージにアップグレードしても、これまでに指摘してきた BLOB ストレージ アカウントとそのストレージ層に固有の機能および制限以外は、まったく変わりません。

## <a name="next-steps"></a>次の手順

### <a name="evaluate-blob-storage-accounts"></a>BLOB ストレージ アカウントを評価する

[リージョン別に BLOB ストレージ アカウントの可用性を確認する](https://azure.microsoft.com/regions/#services)

[Azure Storage のメトリックを有効にして現在のストレージ アカウントの使用状況を評価する](../common/storage-enable-and-view-metrics.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)

[リージョン別に Blob Storage の価格を確認する](https://azure.microsoft.com/pricing/details/storage/)

[データ転送の価格を確認する](https://azure.microsoft.com/pricing/details/data-transfers/)

### <a name="start-using-gpv2-storage-accounts"></a>GPv2 ストレージ アカウントの利用を開始する

[Azure Blob Storage を使用する](../blobs/storage-dotnet-how-to-use-blobs.md)

[Azure Storage との間でのデータの移動](../common/storage-moving-data.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)

[AzCopy コマンド ライン ユーティリティを使用してデータを転送する](../common/storage-use-azcopy.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)

[自分のストレージ アカウントを調べる](http://storageexplorer.com/)
