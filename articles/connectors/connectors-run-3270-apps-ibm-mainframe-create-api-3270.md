---
title: IBM メインフレーム上の 3270 アプリに接続する
description: Azure Logic Apps と IBM 3270 コネクタを使用することにより、3270 画面駆動型アプリを Azure と統合して自動化します
services: logic-apps
ms.suite: integration
author: ChristopherHouser
ms.author: chrishou
ms.reviewer: estfan, valthom
ms.topic: article
ms.date: 03/06/2019
tags: connectors
ms.openlocfilehash: 808eef5424d678559ae94ffd04e41eacd0f16aee
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/27/2020
ms.locfileid: "80371103"
---
# <a name="integrate-3270-screen-driven-apps-on-ibm-mainframes-with-azure-by-using-azure-logic-apps-and-ibm-3270-connector"></a>Azure Logic Apps と IBM 3270 コネクタを使用して IBM メインフレーム上の 3270 画面駆動型アプリを Azure と統合する

> [!NOTE]
> このコネクタは[*パブリック プレビュー*](https://azure.microsoft.com/support/legal/preview-supplemental-terms/)段階です。 

Azure Logic Apps と IBM 3270 コネクタを使用すると、通常は 3270 エミュレーター画面でナビゲートすることにより駆動する IBM メインフレーム アプリにアクセスして、それを実行できます。 これにより、Azure Logic Apps で自動化されたワークフローを作成して、BM メインフレーム アプリを、Azure、Microsoft、その他のアプリ、サービス、システムと統合できます。 コネクタは、TN3270 プロトコルを使用して IBM メインフレームと通信し、Azure Government および Azure China 21Vianet を除くすべての Azure Logic Apps リージョンで使用できます。 ロジック アプリを初めて使用する場合は、「[Azure Logic Apps とは](../logic-apps/logic-apps-overview.md)」を参照してください。

この記事では、3270 コネクタの使用に関する次のことについて説明します。 

* Azure Logic Apps で IBM 3270 コネクタを使用する理由と、コネクタで 3270 画面駆動型アプリが実行される方法

* 3270 コネクタを使用するための前提条件とセットアップ

* 3270 コネクタのアクションをロジック アプリに追加する手順

## <a name="why-use-this-connector"></a>このコネクタを使用する理由

IBM メインフレーム上のアプリにアクセスするには、通常、3270 ターミナル エミュレーター ("グリーン画面" とよく呼ばれます) を使用します。 この方法は、実績のある方法ですが、制限事項があります。 Host Integration Server (HIS) はこれらのアプリを直接操作するのに役立ちますが、場合によっては、画面とビジネス ロジックを分離できないことがあります。 または、ホスト アプリケーションのしくみに関する情報がなくなっているかもしれません。

これらのシナリオを拡張するため、Azure Logic Apps の IBM 3270 コネクタは、3270 Design Tool と連携します。このツールを使用して、特定のタスクに使用されるホスト画面を記録 ("キャプチャ") し、メインフレーム アプリでのそのタスクのナビゲーションのフローを定義し、そのタスクの入力および出力パラメーターでメソッドを定義します。 Design Tool では、その情報が、そのタスクを表すアクションをロジック アプリから呼び出すときに 3270 コネクタで使用されるメタデータに変換されます。

Design Tool からメタデータ ファイルを生成した後は、Azure の統合アカウントにそのファイルを追加します。 これにより、3270 コネクタ アクションを追加すると、ロジック アプリはアプリのメタデータにアクセスできます。 コネクタは、統合アカウントからメタデータ ファイルを読み取り、3270 画面内のナビゲーションを処理し、3270 コネクタ アクションに対してパラメーターを動的に提供します。 ユーザーはホスト アプリケーションにデータを提供することができ、コネクタはロジック アプリに結果を返します。 これにより、Azure Logic Apps でサポートされる Azure、Microsoft、その他のアプリ、サービス、システムと、レガシ アプリを統合できます。

## <a name="prerequisites"></a>前提条件

* Azure サブスクリプション。 Azure サブスクリプションがない場合は、[無料の Azure アカウントにサインアップ](https://azure.microsoft.com/free/)してください。

* [ロジック アプリの作成方法](../logic-apps/quickstart-create-first-logic-app-workflow.md)に関する基本的な知識

* 推奨:[統合サービス環境 (ISE)](../logic-apps/connect-virtual-network-vnet-isolated-environment.md) 

  ロジック アプリを作成および実行するための場所として、この環境を選択できます。 ISE では、ロジック アプリから、Azure 仮想ネットワーク内で保護されているリソースへのアクセスが提供されます。

* 3270 画面駆動型アプリの自動化と実行に使用するロジック アプリ

  IBM 3270 コネクタはトリガーを備えていないので、**繰り返し**トリガーなどの別のトリガーを使って、ロジック アプリを開始します。 その後、3270 コネクタ アクションを追加できます。 始めるには、[空のロジック アプリを作成](../logic-apps/quickstart-create-first-logic-app-workflow.md)します。 
  ISE を使用する場合は、ロジック アプリの場所としてその ISE を選択します。

* [3270 Design Tool をダウンロードしてインストール](https://aka.ms/3270-design-tool-download)します。
唯一の前提条件は [Microsoft .NET Framework 4.6.1](https://aka.ms/net-framework-download) です。

  このツールは、3270 コネクタのアクションとして追加して実行するアプリでのタスクの画面、ナビゲーション パス、メソッド、パラメーターを記録するのに役立ちます。 そのツールでは、メインフレーム アプリの駆動に使用するコネクタに必要なメタデータを提供する Host Integration Designer XML (HIDX) ファイルが生成されます。
  
  このツールをダウンロードしてインストールした後、以下の手順に従ってホストに接続します。

  1. 3270 Design Tool を開きます。 **[Session]\(セッション\)** メニューから **[Host Sessions]\(ホスト セッション\)** を選択します。
  
  1. 使用する TN3270 ホスト サーバーの情報を提供します。

* [統合アカウント](../logic-apps/logic-apps-enterprise-integration-create-integration-account.md)。これは、ロジック アプリが HIDX ファイルのメタデータとメソッドの定義にアクセスできるように、HIDX ファイルがマップとして格納される場所です。 

  使用するロジック アプリに統合アカウントがリンクされていることを確認します。 また、ISE を使用する場合は、統合アカウントの場所が、ロジック アプリで使用するものと同じ ISE であることを確認します。

* メインフレーム アプリがホストされている TN3270 サーバーへのアクセス

<a name="define-app-metadata"></a>

## <a name="create-metadata-overview"></a>メタデータの概要を作成する

3270 画面駆動型アプリでの画面とデータ フィールドはシナリオに固有のため、3270 コネクタではアプリについてのこの情報が必要であり、メタデータとしてそれを提供できます。 このメタデータでは、ロジック アプリが画面を識別して認識するのに役立つ情報、および画面間をナビゲートする方法、データを入力する場所、結果が予想される場所が記述されています。 このメタデータを指定して生成するには、3270 Design Tool を使用します。このツールでは、後で詳細に説明する特定の "*モード*" (ステージ) が順番に示されます。

* **キャプチャ**: このモードでは、メインフレーム アプリで特定のタスクを完了するために必要な画面が記録されます (銀行預金残高の取得など)。

* **ナビゲーション**: このモードでは、特定のタスクのためにメインフレーム アプリの画面間を移動する方法のプランまたはパスを指定します。

* **メソッド**: このモードでは、画面のナビゲーション パスが記述されているメソッド (例: `GetBalance`) を定義します。 また、メソッドの入力および出力パラメーターになる各画面のフィールドを選択します。

### <a name="unsupported-elements"></a>サポートされていない要素

Design Tool では、以下の要素はサポートされていません。

* 部分的な IBM 基本マッピング サポート (BMS) マップ: BMS マップをインポートする場合、Design Tool では画面の部分定義は無視されます。
* 入力/出力パラメーター: 入力/出力パラメーターを定義することはできません。
* メニュー処理: プレビュー期間中はサポートされていません
* 配列処理: プレビュー期間中はサポートされていません

<a name="capture-screens"></a>

## <a name="capture-screens"></a>画面をキャプチャする

このモードでは、その画面を一意に識別する各 3270 画面上の項目をマークします。 たとえば、テキスト行や、特定のテキストと空ではないフィールドなどのさらに複雑な条件のセットを指定できます。 ホスト サーバーへのライブ接続経由でこれらの画面を記録することも、IBM 基本マッピング サポート (BMS) マップからこの情報をインポートすることもできます。 ライブ接続では、ホストに接続するために TN3270 エミュレーターが使用されます。 各コネクタ アクションは、セッションへの接続で開始し、セッションからの切断で終了する、単一のタスクにマップしている必要があります。

1. まだ行っていない場合は、3270 Design Tool を開きます。 ツール バーで **[Capture]\(キャプチャ\)** を選択して、キャプチャ モードに入ります。

1. 記録を開始するには、F5 キーを押すか、または **[Recording]\(記録\)** メニューの **[Start Recording]\(記録開始\)** を選択します。 

1. **[Session]\(セッション\)** メニューから **[Connect]\(接続\)** を選択します。

1. **[Capture]\(キャプチャ\)** ウィンドウで、アプリの最初の画面から始めて、記録している特定のタスクに従ってアプリを順番に操作します。

1. タスクが完了した後は、通常どおりアプリからサインアウトします。

1. **[Session]\(セッション\)** メニューから **[Disconnect]\(切断\)** を選択します。

1. 記録を停止するには、Shift + F5 キーを押すか、または **[Recording]\(記録\)** メニューの **[Stop Recording]\(記録停止\)** を選択します。

   タスクの画面のキャプチャが済むと、Design Tool にそれらの画面を表すサムネイルが表示されます。 これらのサムネイルに関する注意事項:

   * キャプチャされた画面には、"Empty" という名前の画面が含まれます。

     初めて [CICS](https://www.ibm.com/it-infrastructure/z/cics) に接続するときは、実行するトランザクションの名前を入力する前に、"Clear" キーを送信する必要があります。 "Clear" キーを送信する画面には、Screen Recognition エディターを使用して追加できる画面タイトルなどの "*認識属性*" がありません。 この画面を表すため、サムネイルには "Empty" という名前の画面が含まれています。 後でこの画面を使用して、トランザクション名を入力する画面を表すことができます。

   * 既定では、キャプチャされた画面の名前には、画面上の最初の単語が使用されます。 その名前が既に存在する場合、Design Tool では、名前の後にアンダースコアと数字が追加されます (例: "WBGB"、"WBGB_1")。

1. キャプチャした画面によりわかりやすい名前を付けるには、次の手順のようにします。

   1. **[Host Screens]\(ホスト画面\)** ウィンドウで、名前を変更する画面を選択します。

   1. 同じウィンドウの下部に **[Screen Name]\(画面名\)** プロパティがあります。

   1. 現在の画面名をもっとわかりやすい名前に変更します。

1. 各画面を識別するためのフィールドを指定します。

   3270 データ ストリームでは画面に既定の識別子がないので、各画面で一意のテキストを選択する必要があります。 複雑なシナリオでは、複数の条件を指定できます (一意のテキストと、特定の条件を持つフィールドなど)。

認識フィールドの選択が完了したら、次のモードに移動します。

### <a name="conditions-for-identifying-repeated-screens"></a>繰り返される画面を識別するための条件

コネクタが画面間を移動して区別できるよう、通常は、キャプチャした画面間で識別子として使用できる画面上の固有のテキストを探します。 繰り返される画面では、さらに識別方法が必要になる場合があります。 たとえば、2 つの画面があり、1 つの画面では有効な値が返され、他の画面ではエラー メッセージが返されることを除くと、同じように見えるものとします。

Design Tool では、Screen Recognition エディターを使用して、"*認識属性*" (たとえば、"口座残高の取得" のような画面タイトル) を追加できます。 分岐したパスがあり、どちらのブランチも返る画面は同じでも、結果が異なる場合は、他の認識属性が必要です。 実行時に、コネクタではこれらの属性を使用して、現在のブランチと分岐が決定されます。 使用できる条件を次に示します。

* 特定の値: この値は、指定した場所での指定した文字列と一致します。
* 特定の値ではない: この値は、指定した場所での指定した文字列と一致しません。
* 空である: このフィールドは空です。
* 空ではない: このフィールドは空ではありません。

詳しくは、後の「[ナビゲーション プランの例](#example-plan)」をご覧ください。

<a name="define-navigation"></a>

## <a name="define-navigation-plans"></a>ナビゲーション プランを定義する

このモードでは、特定のタスクでメインフレーム アプリの画面間を移動するためのフローまたは手順を定義します。 たとえば、アプリで辿ることのできる複数のパスがあり、1 つのパスでは正しい結果が生成され、他のパスではエラーが生成されるような場合があります。 各画面で、次の画面に移動するために必要なキー ストローク (`CICSPROD <enter>` など) を指定します。

> [!TIP]
> 同じ接続画面と切断画面を使用する複数のタスクを自動化する場合、Design Tool では特別な接続および切断のプランの種類が提供されます。 これらのプランを定義するときに、ナビゲーション プランの先頭と末尾にそれらを追加できます。

### <a name="guidelines-for-plan-definitions"></a>プランの定義に関するガイドライン

* 接続で開始して切断で終了する、すべての画面を含めます。

* スタンドアロン プランを作成するか、または接続プランと切断プランを使用することができます。そうすると、すべてのトランザクションに共通する一連の画面を再利用できます。

  * 接続プランの最後の画面は、ナビゲーション プランの最初の画面と同じ画面にする必要があります。

  * 切断プランの最初の画面は、ナビゲーション プランの最後の画面と同じ画面にする必要があります。

* キャプチャした画面には多くの繰り返し画面が含まれる場合があるので、プランでは繰り返し画面のインスタンスを 1 つだけ選択して使用します。 繰り返し画面の例を次に示します。

  * サインイン画面 (例: **MSG-10** 画面)
  * CICS のようこそ画面
  * "クリア" または **Empty** 画面

<a name="create-plans"></a>

### <a name="create-plans"></a>プランを作成する

1. 3270 Design Tool のツール バーで、 **[Navigation]\(ナビゲーション\)** を選択してナビゲーション モードに入ります。

1. プランを開始するには、 **[Navigation]\(ナビゲーション\)** ウィンドウで **[New Plan]\(新しいプラン\)** を選択します。

1. **[Choose New Plan Name]\(新しいプラン名の選択\)** で、プランの名前を入力します。 **[Type]\(種類\)** の一覧で、プランの種類を選択します。

   | プランの種類 | 説明 |
   |-----------|-------------|
   | **Process** | スタンドアロン プランまたは結合プランの場合 |
   | **Connect** | 接続プランの場合 |
   | **Disconnect (切断)** | 切断プランの場合 |
   |||

1. **[Host Screens]\(ホスト画面\)** ウィンドウから、 **[Navigation]\(ナビゲーション\)** ウィンドウのナビゲーション プラン サーフェスに、キャプチャされたサムネイルをドラッグします。

   トランザクション名を入力する空の画面を表すには、"Empty" 画面を使用します。

1. 定義しているタスクを記述する順序で、画面を配置します。

1. 分岐や結合など、画面間のフロー パスを定義するには、Design Tool のツール バーで、 **[Flow]\(フロー\)** を選択します。

1. フローの最初の画面を選択します。 フローの次の画面までドラッグして接続を描画します。

1. 各画面で、 **[AID Key]\(AID キー\)** プロパティ (アテンション識別子) の値と、フローを次の画面に移動する **[Fixed Text]\(固定テキスト\)** プロパティの値を指定します。

   AID キーだけを指定しても、AID キーと固定テキストの両方を指定してもかまいません。

ナビゲーション プランが完了したら、[次のモードでメソッドを定義する](#define-method)ことができます。

<a name="example-plan"></a>

### <a name="example"></a>例

この例では、次のステップが含まれる "WBGB" という名前の CICS トランザクションを実行するものとします。 

* 最初の画面では、名前と口座を入力します。
* 2 番目の画面では、口座の残高が表示されます。
* "Empty" 画面に終了します。
* CICS から "MSG-10" 画面にサインアウトします。

また、これらの手順を繰り返しますが、正しくないデータを入力してエラーが表示される画面をキャプチャできるものとします。 キャプチャする画面を次に示します。

* MSG-10
* CICS Welcome
* Empty
* WBGB_1 (入力)
* WBGB_2 (エラー)
* Empty_1
* MSG-10_1

ここには一意の名前を持つ多くの画面がありますが、一部の画面は同じ画面です (たとえば、"MSG-10" と "Empty")。 繰り返し画面については、プランではその画面のインスタンスを 1 つだけ使用します。 スタンドアロン プラン、接続プラン、切断プラン、結合プランの表示の例を次に示します。

* スタンドアロン プラン

  ![スタンドアロン ナビゲーション プラン](./media/connectors-create-api-3270/standalone-plan.png)

* 接続プラン

  ![接続プラン](./media/connectors-create-api-3270/connect-plan.png)

* 切断プラン

  ![切断プラン](./media/connectors-create-api-3270/disconnect-plan.png)

* 結合プラン

  ![結合プラン](./media/connectors-create-api-3270/combined-plan.png)

#### <a name="example-identify-repeated-screens"></a>例:繰り返し画面を識別する

コネクタが画面間を移動して区別できるよう、通常は、キャプチャした画面間で識別子として使用できる画面上の固有のテキストを探します。 繰り返される画面では、さらに識別方法が必要になる場合があります。 例のプランには、似た画面が表示される分岐があります。 1 つの画面では口座の残高が返され、もう 1 つの画面ではエラー メッセージが返されます。

Design Tool では、Screen Recognition エディターを使用して、認識属性 (たとえば、"口座残高の取得" という画面タイトル) を追加できます。 画面が似ている場合は、他の属性が必要です。 実行時に、コネクタではこれらの属性を使用して、ブランチと分岐が決定されます。

* 有効な入力を返すブランチ (口座残高の画面) では、"空ではない" 条件を持つフィールドを追加できます。

* エラーを返すブランチでは、"空である" 条件を持つフィールドを追加できます。

<a name="define-method"></a>

## <a name="define-methods"></a>メソッドを定義する

このモードでは、ナビゲーション プランに関連付けるメソッドを定義します。 メソッドの各パラメーターに対し、文字列、整数、日付または時刻などのデータ型を指定します。 完了したら、ライブ ホスト上でメソッドをテストし、メソッドが正常に動作することを確認できます。 その後、メタデータ ファイル (Host Integration Designer XML (HIDX) ファイル) を生成します。このファイルには、IBM 3270 コネクタに対してアクションを作成して実行するために使用するメソッドの定義が含まれます。

1. 3270 Design Tool のツール バーで、 **[Methods]\(メソッド\)** を選択してメソッド モードに入ります。 

1. **[Navigation]\(ナビゲーション\)** ウィンドウで、目的の入力フィールドが含まれる画面を選択します。

1. メソッドの最初の入力パラメーターを追加するには、次の手順のようにします。

   1. **[Capture]\(キャプチャ\)** ウィンドウの 3270 エミュレーター画面で、最初の入力として使用するフィールドの (フィールド内のテキストだけでなく) 全体を選択します。

      > [!TIP]
      > すべてのフィールドを表示し、完全なフィールドを選択したことを確認するには、 **[View]\(表示\)** メニューの **[All Fields]\(すべてのフィールド\)** を選択します。

   1. Design Tool のツール バーで、 **[Input Field]\(入力フィールド\)** を選択します。 

   さらに入力パラメーターを追加するには、各パラメーターについて前の手順を繰り返します。

1. メソッドの最初の出力パラメーターを追加するには、次の手順のようにします。

   1. **[Capture]\(キャプチャ\)** ウィンドウの 3270 エミュレーター画面で、最初の出力として使用するフィールドの (フィールド内のテキストだけでなく) 全体を選択します。

      > [!TIP]
      > すべてのフィールドを表示し、完全なフィールドを選択したことを確認するには、 **[View]\(表示\)** メニューの **[All Fields]\(すべてのフィールド\)** を選択します。

   1. Design Tool のツール バーで、 **[Output Field]\(出力フィールド\)** を選択します。

   さらに出力パラメーターを追加するには、各パラメーターについて前の手順を繰り返します。

1. メソッドのすべてのパラメーターを追加した後は、パラメーターごとに次のプロパティを定義します。

   | プロパティ名 | 指定できる値 | 
   |---------------|-----------------|
   | **[データ型]** | Byte、Date Time、Decimal、Int、Long、Short、String |
   | **Field Fill Technique (フィールドの入力方法)** | パラメーターでは次の入力方法がサポートされており、必要に応じて空白が埋められます。 <p><p>-  **[Type]\(入力\)** : フィールドに順番に文字を入力します。 <p>-  **[Fill]\(埋める\)** : フィールドの内容を文字で置き換え、必要に応じて空白で埋めます。 <p>-  **[EraseEofType]\(EOF を消去して入力\)** : フィールドをクリアしてから、フィールドに順番に文字を入力します。 |
   | **Format String (書式設定文字列)** | 一部のパラメーターのデータ型では、書式設定文字列が使用されます。これは、画面から .NET データ型に変換する方法を 3270 コネクタに指示します。 <p><p>-  **[DateTime]\(日時\)** : DateTime 書式設定文字列は、[.NET カスタム日付/時刻の書式設定文字列](https://docs.microsoft.com/dotnet/standard/base-types/custom-date-and-time-format-strings)に従います。 たとえば、日付 `06/30/2019` では、書式設定文字列 `MM/dd/yyyy` を使用します。 <p>-  **[Decimal]\(10 進\)** : 10 進形式の文字列では、[COBOL Picture 句](https://www.ibm.com/support/knowledgecenter/SS6SG3_5.2.0/com.ibm.cobol52.ent.doc/PGandLR/ref/rlddepic.html)を使用します。 たとえば、数値 `100.35` では、書式設定文字列 `999V99` を使用します。 |
   |||

## <a name="save-and-view-metadata"></a>メタデータを保存して表示する

メソッドを定義した後、メソッドをテストする前に、これまでに定義したすべての情報を RAP (.rap) ファイルに保存します。
どのモードでもいつでもこの RAP ファイルに保存できます。 Design Tool のインストール フォルダーの次の場所にはサンプルの RAP ファイル "WoodgroveBank.rap" があり、これを開いて確認できます。

`..\Program Files\Microsoft Host Integration Server - 3270 Design Tool\SDK\WoodgroveBank.rap`

ただし、サンプル RAP ファイルに変更を保存しようとすると、またはファイルを Design Tool のインストール フォルダーに置いたままサンプル RAP ファイルから HIDX ファイルを生成しようとすると、"アクセス拒否" エラーが発生することがあります。 既定では、Design Tool は管理者特権なしで Program Files フォルダーにインストールされます。 エラーが発生する場合は、次のいずれかの解決策を試してください。

* サンプル ファイルを別の場所にコピーします。
* Design Tool を管理者として実行します。
* 自分を SDK フォルダーの所有者にします。

## <a name="test-your-method"></a>メソッドをテストする

1. ライブ ホストに対してメソッドを実行するには、メソッド モードの間に、F5 キーを押すか、または Design Tool のツールバーの **[Run]\(実行\)** を選択します。

   > [!TIP]
   > モードはいつでも変更できます。 **[File]\(ファイル\)** メニューの **[Mode]\(モード\)** を選択し、目的のモードを選択します。

1. パラメーターの値を入力して、 **[OK]** を選択します。

1. 次の画面に進むには、 **[Next]\(次へ\)** を選択します。

1. 完了したら、 **[Done]\(完了\)** を選択すると、出力パラメーターの値が表示されます。

<a name="add-metadata-integration-account"></a>

## <a name="generate-and-upload-hidx-file"></a>HIDX ファイルを生成してアップロードする

準備ができたら、統合アカウントにアップロードできるように、HIDX ファイルを生成します。 3270 Design Tool では、RAP ファイルを保存した新しいサブフォルダーに HIDX ファイルが作成されます。

1. 3270 Design Tool のツール バーで、 **[Generate Code]\(コードの生成\)** を選択します。

1. RAP ファイルが含まれるフォルダーに移動し、HIDX ファイルの生成後にツールによって作成されたサブフォルダーを開きます。 ツールで HIDX ファイルが作成されたことを確認します。

1. [Azure portal](https://portal.azure.com) にサインインし、統合アカウントを探します。

1. [マップを追加するための似た手順に従い](../logic-apps/logic-apps-enterprise-integration-liquid-transform.md)、統合アカウントに対するマップとして HIDX ファイルを追加します。ただし、マップの種類を選択するときに、**HIDX** を選択します。

このトピックで後ほど、初めてロジック アプリに IBM 3270 アクションを追加するときに、接続情報 (統合アカウントとホスト サーバーの名前など) を指定して、ロジック アプリとホスト サーバーの間の接続を作成するよう求められます。 接続を作成した後は、前に追加した HIDX ファイル、実行するメソッド、および使用するパラメーターを選択できます。

すべての手順が完了すると、IBM メインフレームに接続するためにロジック アプリで作成したアクションを使用したり、アプリの画面の駆動、データの入力、結果の取得などを行ったりできます。 また、他のアプリ、サービス、システムと統合するため、ロジック アプリへの他のアクションの追加を続けることもできます。

<a name="run-action"></a>

## <a name="run-ibm-3270-actions"></a>IBM 3270 のアクションを実行する

[!INCLUDE [Create connection general intro](../../includes/connectors-create-connection-general-intro.md)]

1. [Azure portal](https://portal.azure.com) にサインインし、ロジック アプリ デザイナーでロジック アプリを開きます (まだ開いていない場合)。

1. アクションを追加する最後のステップで、 **[新しいステップ]** を選択し、 **[アクションの追加]** を選択します。 

1. 検索ボックスで、 **[エンタープライズ]** を選択します。 検索ボックスに、フィルターとして「3270」と入力します。 アクションの一覧から、次のアクションを選択します。**TN3270 接続経由でメインフレーム プログラムを実行する**

   ![3270 のアクションを選択する](./media/connectors-create-api-3270/select-3270-action.png)

   ステップの間にアクションを追加するには、ステップ間の矢印の上にポインターを移動します。 
   表示されるプラス記号 ( **+** ) を選択し、 **[アクションの追加]** を選択します。

1. まだ接続が存在しない場合は、接続に必要な情報を指定し、 **[作成]** を選択します。

   | プロパティ | 必須 | 値 | 説明 |
   |----------|----------|-------|-------------|
   | **Connection Name** | はい | <*connection-name*> | 接続の名前 |
   | **統合アカウント ID** | はい | <*integration-account-name*> | 統合アカウントの名前 |
   | **統合アカウント SAS URL** | はい | <*integration-account-SAS-URL*> | 統合アカウントの Shared Access Signature (SAS) URL。これは、Azure portal で統合アカウントの設定から生成できます。 <p>1.統合アカウント メニューの **[設定]** で、 **[コールバック URL]** を選択します。 <br>2.右側のウィンドウで、 **[生成されたコールバック URL]** の値をコピーします。 |
   | **[サーバー]** | はい | <*TN3270-server-name*> | TN3270 サービスのサーバー名 |
   | **[ポート]** | いいえ | <*TN3270-server-port*> | TN3270 サーバーによって使用されるポート。 空白のままにすると、コネクタでは既定値として `23` が使用されます。 |
   | **デバイスの種類** | いいえ | <*IBM-terminal-model*> | エミュレートする IBM 端末のモデルの名前または番号。 空白のままにすると、コネクタでは既定値が使用されます。 |
   | **コード ページ** | いいえ | <*code-page-number*> | ホストのコード ページ番号。 空白のままにすると、コネクタでは既定値として `37` が使用されます。 |
   | **論理ユニット名** | いいえ | <*logical-unit-name*> | ホストから要求する特定の論理ユニット名 |
   | **SSL を有効にしますか?** | いいえ | [オン] または [オフ] | TLS 暗号化を有効または無効にします。 |
   | **Validate host ssl certificate? (ホストの SSL 証明書を検証しますか?)** | いいえ | [オン] または [オフ] | サーバーの証明書の検証を有効または無効にします。 |
   ||||

   次に例を示します。

   ![接続のプロパティ](./media/connectors-create-api-3270/connection-properties.png)

1. アクションに必要な情報を指定します。

   | プロパティ | 必須 | 値 | 説明 |
   |----------|----------|-------|-------------|
   | **hidx 名** | はい | <*HIDX-file-name*> | 使用する 3270 HIDX ファイルを選択します。 |
   | **メソッド名** | はい | <*method-name*> | 使用する HIDX ファイル内のメソッドを選択します。 メソッドを選択すると、 **[新しいパラメーターの追加]** の一覧が表示されるので、そのメソッドで使用するパラメーターを選択できます。 |
   ||||

   次に例を示します。

   **HIDX ファイルを選択する**

   ![HIDX ファイルを選択する](./media/connectors-create-api-3270/select-hidx-file.png)

   **メソッドを選択する**

   ![メソッドを選択する](./media/connectors-create-api-3270/select-method.png)

   **パラメーターを選択する**

   ![パラメーターを選択する](./media/connectors-create-api-3270/add-parameters.png)

1. 完了したら、ロジック アプリを保存して実行します。

   ロジック アプリの実行が終了した後で、実行からの手順が表示されます。 
   手順が成功した場合はチェック マークが表示され、失敗した場合は文字 "X" が表示されます。

1. 各ステップの入力と出力を確認するには、そのステップを展開します。

1. 出力を確認するには、 **[未加工出力の表示]** を選択します。

## <a name="connector-reference"></a>コネクタのレファレンス

コネクタの Swagger ファイルに記述される、トリガー、アクション、制限などのこのコネクタの技術的詳細については、[コネクタの参照ページ](https://docs.microsoft.com/connectors/si3270/)を参照してください。

> [!NOTE]
> [統合サービス環境 (ISE)](../logic-apps/connect-virtual-network-vnet-isolated-environment-overview.md) のロジック アプリの場合、このコネクタの ISE のラベルが付いたバージョンでは、代わりに [ISE メッセージ制限](../logic-apps/logic-apps-limits-and-config.md#message-size-limits)が使用されます。

## <a name="next-steps"></a>次のステップ

* 他の[Logic Apps コネクタ](../connectors/apis-list.md)を確認します。
