---
title: Site Recovery を使用した、セカンダリ データ センターにレプリケートされた Hyper-V VM のフェールオーバーとフェールバック | Microsoft Docs
description: Azure Site Recovery を使用して、Hyper-V VM をセカンダリ オンプレミス サイトにフェールオーバーし、プライマリ サイトにフェールバックする方法を説明します。
services: site-recovery
author: rayne-wiselman
manager: carmonm
ms.service: site-recovery
ms.topic: article
ms.date: 07/06/2018
ms.author: raynew
ms.openlocfilehash: b3ca7be647ff7db0d147eca57edb20e658a28130
ms.sourcegitcommit: a06c4177068aafc8387ddcd54e3071099faf659d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/09/2018
ms.locfileid: "37919473"
---
# <a name="fail-over-and-fail-back-hyper-v-vms-replicated-to-your-secondary-on-premises-site"></a>セカンダリ オンプレミス サイトにレプリケートされた Hyper-V VM のフェールオーバーとフェールバック

[Azure Site Recovery](site-recovery-overview.md) サービスは、オンプレミスのコンピュータと Azure 仮想マシン (VM) のレプリケーション、フェールオーバー、およびフェールバックの管理と調整を行います。

この記事では、System Center Virtual Machine Manager (VMM) クラウドで管理されている Hyper-V VM を、セカンダリ VMM サイトにフェールオーバーする方法について説明します。 フェールオーバーした後、オンプレミス サイトが使用可能になったときにオンプレミス サイトにフェールバックします。 この記事では、次のことについて説明します:

> [!div class="checklist"]
> * Hyper-V VM をプライマリ VMM クラウドからセカンダリ VMM クラウドにフェールオーバーする
> * セカンダリ サイトからプライマリ サイトに再保護し、フェールバックする
> * 必要に応じてプライマリからセカンダリへのレプリケーションを再度開始する

## <a name="failover-and-failback"></a>フェールオーバーとフェールバック

フェールオーバーとフェールバックには 3 つの段階があります。

1. **セカンダリ サイトへのフェールオーバー**: マシンをプライマリ サイトからセカンダリ サイトにフェールオーバーします。
2. **セカンダリ サイトからのフェールバック**: VM をセカンダリからプライマリにレプリケートし、計画されたフェールオーバーを実行してフェールバックします。
3. 計画されたフェールオーバーの後、必要に応じてプライマリからセカンダリへのレプリケーションを再度開始します。


## <a name="prerequisites"></a>前提条件

- すべてが予想どおりに動作することを確認するための[ディザスター リカバリー訓練](hyper-v-vmm-test-failover.md)を完了している必要があります。
- フェールバックを完了するには、プライマリとセカンダリ VMM サーバーが Site Recovery に接続されている必要があります。



## <a name="run-a-failover-from-primary-to-secondary"></a>プライマリからセカンダリへのフェールオーバーを実行する

Hyper-V VM の通常のフェールオーバーまたは計画されたフェールオーバーを実行できます。

- 通常のフェールオーバーは、予期しない停電時に使用します。 このフェールオーバーを実行すると、Site Recovery はセカンダリ サイトに VM を作成し、電源を投入します。 同期されていない保留中のデータによっては、データの損失が発生する可能性があります。
- 計画されたフェールオーバーは、メンテナンスや想定された停止時に使用できます。 このオプションではデータ損失は発生しません。 計画されたフェールオーバーがトリガーされると、ソース VM がシャット ダウンされます。 同期されていないデータが同期され、フェールオーバーがトリガーされます。 
- 
この手順では、通常のフェールオーバーを実行する方法について説明します。


1. **[設定]** > **[レプリケートされたアイテム]** で、[VM] > **[フェールオーバー]** をクリックします。
1. Site Recovery でフェールオーバーをトリガーする前にそのソース VM をシャットダウンする場合は、**[フェールオーバーを開始する前にマシンをシャットダウンします]** を選択します。 Site Recovery はフェールオーバーをトリガーする前に、セカンダリ サイトに送信されていないオンプレミス データの同期を試行します。 シャットダウンが失敗した場合でも、フェールオーバーは続行されることに注意してください。 フェールオーバーの進行状況は **[ジョブ]** ページで確認できます。
2. ここで、セカンダリ VMM クラウド内の VM を確認できます。
3. VM を確認したら、フェールオーバーを**コミット**します。 これにより、利用可能なすべての復旧ポイントが削除されます。

> [!WARNING]
> **進行中のフェールオーバーをキャンセルしないでください**。フェールオーバーが開始される前に VM のレプリケーションが停止します。 進行中のフェールオーバーをキャンセルすると、フェールオーバーは停止しますが、VM が再びレプリケートされることはありません。  


## <a name="reverse-replicate-and-failover"></a>レプリケーションの反転とフェールオーバー

プライマリ サイトからセカンダリ サイトへのレプリケートを開始し、プライマリ サイトにフェールバックします。 プライマリ サイトで VM が再度実行するようになった後、VM をセカンダリ サイトにレプリケートできます。  

 
1. VM をクリックし、**[レプリケーションの反転]** をクリックします。
2. ジョブが完了した後、VM をクリックし、**[フェールオーバー]** でフェールオーバーの方向 (セカンダリ VMM クラウドから) を確認して、ソースとターゲットの場所を選択します。 
4. フェールオーバーを開始します。 フェールオーバーの進行状況は、 **[ジョブ]** タブで確認できます。
5. プライマリ VMM クラウドで、VM が使用可能であることを確認します。
6. プライマリ VM をセカンダリ サイトに再度レプリケーションする場合は、**[レプリケーションの反転]** をクリックします。

## <a name="next-steps"></a>次の手順
Hyper-V VM をセカンダリ サイトにレプリケートする手順については、[こちら](hyper-v-vmm-disaster-recovery.md)を参照してください。
