---
title: Azure Site Recovery で Azure VM のレプリケーションを構成する | Microsoft Docs
description: この記事では、Site Recovery を使用して、1 つの Azure リージョンから別のリージョンへの Azure VM のレプリケーションを構成する方法について説明します。
services: site-recovery
author: asgang
manager: rochakm
ms.service: site-recovery
ms.topic: article
ms.date: 07/06/2018
ms.author: asgang
ms.openlocfilehash: e7cd3032053b3628b94f93f3c7e00b6890afd4ca
ms.sourcegitcommit: a06c4177068aafc8387ddcd54e3071099faf659d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/09/2018
ms.locfileid: "37916284"
---
# <a name="replicate-azure-virtual-machines-to-another-azure-region"></a>Azure 仮想マシンを別の Azure リージョンにレプリケートする



この記事では、1 つの Azure リージョンから別のリージョンへの Azure VM のレプリケーションを有効にする方法について説明します。

## <a name="prerequisites"></a>前提条件

この記事では、[Azure から Azure へのチュートリアル](azure-to-azure-tutorial-enable-replication.md)で説明されているように、このシナリオ用の Site Recovery を既にセットアップしてあることを前提としています。 前提条件が満たされ、Recovery Services コンテナーが作成してあることを確認してください。



## <a name="enable-replication"></a>レプリケーションを有効にする

レプリケーションを有効にします。 この手順では、プライマリ Azure リージョンが東アジアで、セカンダリ リージョンが東南アジアであることを前提としています。

1. コンテナーで、**[+レプリケート]** をクリックします。
2. 以下のフィールドに注意してください。
    - **ソース**: VM の起点。この例では **Azure** です。
    - **ソースの場所**: 仮想マシンの保護を行う Azure リージョン。 ここでは、ソースの場所は "東アジア" です
    - **デプロイ モデル**: ソース マシンの Azure デプロイ モデル。
    - **リソース グループ**: ソース仮想マシンが属しているリソース グループ。 選択したリソース グループのすべての VM が、次の手順で保護対象として表示されます。

    ![レプリケーションを有効にする](./media/site-recovery-replicate-azure-to-azure/enabledrwizard1.png)

3. **[仮想マシン] > [仮想マシンの選択]** で、レプリケートする各 VM をクリックして選択します。 選択できるのは、レプリケーションを有効にできるマシンのみです。 次に、 **[OK]** をクリックします
    ![Enable replication](./media/site-recovery-replicate-azure-to-azure/virtualmachine_selection.png)

4. **[設定]** では、オプションで、以下のターゲット サイトの設定を構成できます。

    - **ターゲットの場所**: ソース仮想マシンのデータがレプリケートされる場所。 選択したマシンの場所に応じて、適切なターゲット リージョンの一覧が表示されます。 ターゲットの場所は、Recovery Services コンテナーと同じ場所にすることをお勧めします。
    - **ターゲット リソース グループ**: レプリケートされたすべての仮想マシンが属するリソース グループ。 既定では、Azure Site Recovery によって、名前に "asr" サフィックスが付いた新しいリソース グループがターゲット リージョンに作成されます。 Azure Site Recovery によって作成されるリソース グループが既に存在する場合は、そのグループが再利用されます。 以下のセクションで示すように、それをカスタマイズすることもできます。 ターゲット リソース グループの場所は、ソース仮想マシンがホストされているリージョンを除き、どの Azure リージョンでも構いません。
    - **ターゲット仮想ネットワーク**: 既定では、名前に "asr" サフィックスが付いた新しい仮想ネットワークが、Site Recovery によってターゲット リージョンに作成されます。 これはソース ネットワークにマップされ、今後の保護で使用されます。 ネットワーク マッピングの詳細については、[こちら](site-recovery-network-mapping-azure-to-azure.md)を参照してください。
    - **ターゲット ストレージ アカウント (ソース VM で管理ディスクが使用されていない場合)**: 既定では、Site Recovery によって、ソース VM ストレージと同じ構成で新しいターゲット ストレージ アカウントが作成されます。 ストレージ アカウントが既に存在する場合は、再利用されます。
    - **レプリカ管理ディスク (ソース VM で管理ディスクが使用されている場合)**: Site Recovery によってターゲット リージョンに新しいレプリカ管理ディスクが作成され、ソース VM の管理ディスクと同じストレージ タイプ (標準またはプレミアム) でソース VM の管理ディスクがミラーリングされます。
    - **キャッシュ ストレージ アカウント**: Site Recovery では、キャッシュ ストレージと呼ばれる追加のストレージ アカウントがソース リージョンに必要です。 ソース VM で行われてた変更はすべて追跡され、キャッシュ ストレージ アカウントに送信されてから、ターゲットの場所にレプリケートされます。
    - **可用性セット**: 既定では、名前に "asr" サフィックスが付いた新しい可用性セットが、Azure Site Recovery によってターゲット リージョンに作成されます。 Azure Site Recovery によって作成された可用性セットが既に存在する場合は、それが再利用されます。
    - **レプリケーション ポリシー**: 復旧ポイントのリテンション履歴と、アプリ整合性スナップショットの頻度の設定を定義します。 既定では、Azure Site Recovery によって、既定の設定 (復旧ポイントのリテンション期間が "24 時間"、アプリ整合性スナップショットの頻度が "60 分") で新しいレプリケーション ポリシーが作成されます。

    ![レプリケーションを有効にする](./media/site-recovery-replicate-azure-to-azure/enabledrwizard3.PNG)

## <a name="customize-target-resources"></a>ターゲット リソースのカスタマイズ

Site Recovery によって使用される既定のターゲット設定を変更することができます。

1. **[カスタマイズ]** をクリックして、既定の設定を次のように変更します。
    - **ターゲット リソース グループ**で、サブスクリプションのターゲットの場所にあるすべてのリソース グループの一覧から、リソース グループを選択します。
    - **ターゲット仮想ネットワーク**で、ターゲットの場所にあるすべての仮想ネットワークの一覧から、ネットワークを選択します。
    - **可用性セット**では、可用性セットの設定を、それらがソース リージョンの可用性セットの一部であれば、VM に追加できます。
    - **ターゲット ストレージ アカウント**で、使用するアカウントを選択します。

        ![レプリケーションを有効にする](./media/site-recovery-replicate-azure-to-azure/customize.PNG)

2. **[Create target resource]\(ターゲット リソースを作成する\)** > **[レプリケーションを有効にする]** の順にクリックします。
3. VM のレプリケーションが有効になったら、**[レプリケートされたアイテム]** で VM の正常性の状態を確認できます。

>[!NOTE]
>初期レプリケーションの間は、状態の更新に少し時間がかかり、進捗が見られない場合があります。 **[更新]** ボタンをクリックして、最新の状態を取得します。
>

# <a name="next-steps"></a>次の手順

テスト フェールオーバーの実行に関する[詳細を確認](site-recovery-test-failover-to-azure.md)する。
