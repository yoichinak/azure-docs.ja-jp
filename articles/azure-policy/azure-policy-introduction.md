---
title: Azure Policy の概要
description: Azure Policy は Azure のサービスであり、Azure 環境でのポリシー定義の作成、割り当て、管理に使うことができます。
services: azure-policy
author: DCtheGeek
ms.author: dacoulte
ms.date: 07/31/2018
ms.topic: overview
ms.service: azure-policy
manager: carmonm
ms.custom: mvc
ms.openlocfilehash: 405f69ae1c37e478758d984ddf7dc0e267910fef
ms.sourcegitcommit: 1aedb52f221fb2a6e7ad0b0930b4c74db354a569
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/17/2018
ms.locfileid: "42023521"
---
# <a name="what-is-azure-policy"></a>Azure Policy とは

IT ガバナンスは、組織が IT の効率的かつ効果的な使用によって、その組織のゴールを達成できるようにします。 これは、ビジネスのゴールと IT プロジェクトの間の関係を明確にすることによって実現します。

解決できそうもないほど多くの IT の問題を企業が抱えている場合は、
優れた IT ガバナンスには、イニシアチブの計画と、問題の管理と防止に役立つ戦略的レベルの優先順位の設定が含まれます。 そのような場合は、Azure Policy を利用できます。

Azure Policy は、ポリシーの作成、割り当て、管理に使用する Azure のサービスです。 これらのポリシーは、リソースにさまざまなルールと効果を適用して、それらのリソースが会社の標準とサービス レベル アグリーメントに準拠した状態に保たれるようにします。 そのために、Azure Policy はリソースの評価を実行し、作成済みのポリシーに準拠していないリソースをスキャンします。 たとえば、環境内で特定の SKU サイズの仮想マシンのみを許可するポリシーを作成できます。 このポリシーが実装されると、既存のリソースに対してだけでなく、リソースの作成時と更新時にもポリシーが評価されます。 Azure Policy でポリシーを作成して実装する方法については、このドキュメントの後のほうで詳しく説明します。

> [!IMPORTANT]
> Azure Policy のコンプライアンス評価が、価格レベルに関係なくすべての割り当てに対して提供されるようになりました。 割り当てにコンプライアンス データが表示されない場合は、サブスクリプションが Microsoft.PolicyInsights リソース プロバイダーに登録されていることを確認してください。

## <a name="how-is-it-different-from-rbac"></a>RBAC との違いは何か。

ポリシーとロールベースのアクセス制御 (RBAC) には、いくつかの主要な違いがあります。 RBAC は、さまざまなスコープでのユーザーの操作に焦点を当てています。 たとえば、ご自身が、目的のスコープでリソース グループの共同作成者ロールに追加されている場合があります。 このロールにより、そのリソース グループを変更できます。
ポリシーは、既存のリソースについて、デプロイ中のプロパティに焦点を当てます。 たとえば、ポリシーを使用して、プロビジョニングできるリソースの種類を制御できます。 また、リソースをプロビジョニングできる場所を制限できます。 RBAC とは異なり、ポリシーは既定で許可し、明示的に否認するシステムです。

### <a name="rbac-permissions-in-azure-policy"></a>Azure Policy における RBAC アクセス許可

Azure Policy には、2 つの異なるリソース プロバイダーでの操作として表されるアクセス許可があります。

- [Microsoft.Authorization](../role-based-access-control/resource-provider-operations.md#microsoftauthorization)
- [Microsoft.PolicyInsight](../role-based-access-control/resource-provider-operations.md#microsoftpolicyinsights)

組み込みロールのいくつかは、Azure Policy のリソースに対するさまざまなレベルのアクセス許可を持ちます。たとえば、**セキュリティ管理者**はポリシーの割り当てと定義を管理できますが、コンプライアンス情報の表示はできません。**閲覧者**は、ポリシーの割り当てと定義に関する詳細情報を読み取れますが、コンプライアンス情報の変更や表示はできません。 一方、**所有者**は完全な権利を持ち、**共同作成者**は Azure Policy のアクセス許可を一切持ちません。 Policy のコンプライアンスの詳細情報を表示するアクセス許可を付与するには、[カスタム ロール](../role-based-access-control/custom-roles.md)を作成します。

## <a name="policy-definition"></a>ポリシー定義

Azure Policy でポリシーを作成して実装する手順は、ポリシー定義の作成から始まります。 すべてのポリシー定義に、ポリシーが強制される条件があります。 また、それには、条件が満たされた場合に実行される付随する効果も含まれます。

Azure Policy には、既定で使うことができる組み込みポリシーがいくつかあります。 例: 

- **SQL Server 12.0 を必要とする**: このポリシー定義の条件/ルールでは、すべての SQL Server がバージョン 12.0 を使うことが保証されます。 その効果として、これらの条件を満たしていないすべてのサーバーが拒否されます。
- **許可されるストレージ アカウント SKU**: このポリシー定義の一連の条件/ルールでは、デプロイされているストレージ アカウントが SKU サイズのセット内かどうかが判定されます。 その効果として、定義されている SKU サイズのセットに準拠していないすべてのストレージ アカウントが拒否されます。
- **許可されるリソースの種類**: このポリシー定義の一連の条件/ルールでは、組織がデプロイできるリソースの種類が指定されます。 その効果として、この定義済みリストの一部ではないすべてのリソースが拒否されます。
- **許可された場所**: このポリシーでは、リソースをデプロイするときに組織が指定できる場所を制限できます。 その効果は、geo コンプライアンス要件を強制するために使用されます。
- **許可された仮想マシンの SKU**: このポリシーでは、組織がデプロイできる一連の仮想マシン SKU を指定できます。
- **タグとその既定値を適用**: このポリシーは、必要なタグとその既定値を適用します (ユーザーによって指定されていない場合)。
- **タグとその値を強制**: このポリシーは、必要なタグとその値をリソースに強制します。
- **許可されないリソースの種類**: このポリシーでは、組織がデプロイできないリソースの種類を指定できます。

これらのポリシー定義 (組み込み定義とカスタム定義の両方) を実装するには、割り当てを行う必要があります。 こうしたポリシーを割り当てるには、Azure Portal、PowerShell、または Azure CLI を使用します。

ポリシーの再評価は、およそ 1 時間に 1 回行われます。つまり、ポリシーを実装 (ポリシー割り当てを作成) した後にポリシー定義に変更を加えた場合、1 時間以内にリソースに対してポリシーが再評価されます。

ポリシー定義の構造の詳細については、[ポリシー定義の構造](policy-definition.md)に関するページを参照してください。

## <a name="policy-assignment"></a>ポリシー割り当て

ポリシー割り当ては、特定のスコープ内で実行するように割り当てられたポリシー定義です。 このスコープの範囲は、[管理グループ](../azure-resource-manager/management-groups-overview.md)からリソース グループまでです。 "*スコープ*" という用語は、ポリシー定義が割り当てられる、すべてのリソース グループ、サブスクリプション、または管理グループのことを指します。 ポリシー割り当ては、すべての子リソースによって継承されます。 つまり、リソース グループに適用されたポリシーは、そのリソース グループ内のすべてのリソースに適用されます。 ただし、サブスコープを、ポリシーの割り当てから除外できます。

たとえば、サブスクリプション スコープで、ネットワーク リソースの作成を禁止するポリシーを割り当てることができます。 ただし、ネットワーク インフラストラクチャを対象とした 1 つのリソース グループを、そのサブスクリプション内で除外します。 このネットワーク リソース グループへのアクセスは、信頼できるユーザーに許可し、そのユーザーがネットワーク リソースを作成できるようにします。

別の例として、リソースの種類のホワイトリスト ポリシーを管理グループ レベルで割り当てたいとしましょう。 そのうえで、より制限の緩やかな (より多くのリソースの種類を許可する) ポリシーを子の管理グループまたはサブスクリプションに直接割り当てます。 しかし、この例はうまくいきません。ポリシーは、明示的拒否のシステムであるためです。 代わりに、管理グループ レベルのポリシーの割り当てから、子の管理グループまたはサブスクリプションを除外する必要があります。 そのうえで、より制限の緩やかなポリシーを子の管理グループまたはサブスクリプション レベルで割り当てます。 簡単に言うと、いずれかのポリシーでリソースが拒否される場合、拒否ポリシーに変更を加えることが、そのリソースを許可する唯一の方法となります。

ポリシー定義と割り当ての設定の詳細については、「[ポリシーの割り当てを作成し、Azure 環境内の非対応リソースを特定する](assign-policy-definition.md)」を参照してください。

## <a name="policy-parameters"></a>ポリシー パラメーター

ポリシー パラメーターは、作成する必要があるポリシー定義の数を減らしてポリシーの管理を簡素化するのに役立ちます。 ポリシー定義を作成するときにパラメーターを定義して、ポリシー定義を汎用化できます。 その後、そのポリシー定義を、さまざまなシナリオで再利用できます。 これを行うには、ポリシー定義を割り当てるときに、さまざまな値を渡します。 たとえば、サブスクリプションに対して一連の場所を指定します。

パラメーターは、ポリシー定義を作成するときに定義/作成します。 パラメーターを定義するときは、名前と、必要に応じて値を指定します。 たとえば、"*場所*" というポリシーのパラメーターを定義できます。 その後、ポリシーを割り当てるときに、*EastUS*、*WestUS* など、さまざまな値を指定できます。

ポリシー パラメーターについて詳しくは、「[リソース ポリシーの概要 - パラメーター](policy-definition.md#parameters)」をご覧ください。

## <a name="initiative-definition"></a>イニシアチブ定義

イニシアチブ定義は、単一の包括的なゴールを達成することを目的として調整されたポリシー定義のコレクションです。 イニシアチブ定義により、ポリシー定義の管理と割り当てが簡素化されます。 簡素化するには、一連のポリシーを 1 つのアイテムとしてグループ化します。 たとえば、Azure Security Center で利用可能なすべてのセキュリティ推奨事項を監視することを目的とする、"**Azure Security Center での監視を有効にする**" というタイトルのイニシアチブを作成できます。

このイニシアチブでは、次のようなポリシー定義を作成します。

- **暗号化されていない SQL Database を Security Center で監視する** – 暗号化されていない SQL データベースとサーバーを監視します。
- **OS の脆弱性を Security Center で監視する** – 構成されているベースラインを満たしていないサーバーを監視します。
- **不足している Endpoint Protection を Security Center で監視する** – Endpoint Protection エージェントがインストールされていないサーバーを監視します。

## <a name="initiative-assignment"></a>イニシアチブ割り当て

ポリシー割り当てと同様に、イニシアチブ割り当ては特定のスコープに割り当てられたイニシアチブの定義です。 イニシアチブを割り当てると、スコープごとに複数のイニシアチブを割り当てる必要性が低下します。 このスコープは、管理グループからリソース グループの範囲になる可能性があります。

前の例の **Azure Security Center での監視を有効にする**イニシアチブを、異なるスコープに割り当てることができます。 たとえば、ある割り当てを **subscriptionA** に割り当てることができます。
別の割り当てを **subscriptionB** に割り当てることができます。

## <a name="initiative-parameters"></a>イニシアチブ パラメーター

ポリシー パラメーターと同様に、イニシアチブ パラメーターは冗長性を減らすことでイニシアチブの管理を簡素化できます。 イニシアチブ パラメーターは、基本的に、イニシアチブ内のポリシー定義によって使われるパラメーターのリストです。

たとえば、イニシアチブ定義 **initiativeC** にポリシー定義 **policyA** と **policyB** が含まれており、それぞれのポリシー定義が異なる種類のパラメーターを予期しているというシナリオについて考えてみましょう。

| ポリシー | パラメーターの名前 |パラメーターの型  |Note |
|---|---|---|---|
| policyA | allowedLocations | array  |このパラメーターは、パラメーターの型が配列として定義されているため、文字列のリストが値として必要です。 |
| policyB | allowedSingleLocation |文字列 |このパラメーターは、パラメーターの型が文字列として定義されているため、1 つの単語が値として必要です。 |

このシナリオで **initiativeC** のイニシアチブ パラメーターを定義する場合、3 つのオプションがあります。

- このイニシアチブのポリシー定義のパラメーターを利用します。この例では、*allowedLocations* と *allowedSingleLocation* が **initiativeC** のイニシアチブ パラメーターになります。
- このイニシアチブ定義内でポリシー定義のパラメーターに値を指定します。 この例では、**policyA のパラメーター – allowedLocations** および **policyB のパラメーター – allowedSingleLocation** に場所のリストを提供できます。 このイニシアチブを割り当てるときに値を指定することもできます。
- このイニシアチブを割り当てるときに使うことができる "*値*" オプションのリストを指定します。 このイニシアチブを割り当てるときは、イニシアチブ内のポリシー定義から継承したパラメーターは、この指定されたリストの値だけを持つことができます。

たとえば、*EastUS*、*WestUS*、*CentralUS*、および *WestEurope* を含むイニシアチブ定義で、値オプションのリストを作成する場合があります。 この場合、"*東南アジア*" などの異なる値はリストに含まれないので、イニシアチブ割り当てで入力できません。

## <a name="maximum-count-of-policy-objects"></a>ポリシー オブジェクトの最大数

[!INCLUDE [policy-limits](../../includes/azure-policy-limits.md)]

## <a name="recommendations-for-managing-policies"></a>ポリシー管理に関する推奨事項

ポリシーの定義と割り当てを作成および管理するときに従うことが推奨される指針と、留意する必要があるヒントをいくつか以下に示します。

- 環境でポリシー定義を作成する場合、最初は、拒否効果ではなく監査効果を定義して、環境のリソースでのポリシー定義の影響を追跡することをお勧めします。 アプリケーションを自動スケールアップするスクリプトが既にある場合、拒否効果を設定すると、このような自動化タスクが妨げられる場合があります。
- 定義と割り当てを作成するときは、組織階層に留意することが重要です。 高いレベルで定義を作成し (たとえば、管理グループやサブスクリプションのレベル)、次の子レベルに割り当てることをお勧めします。 たとえば、管理グループ レベルでポリシー定義を作成した場合、その定義のポリシー割り当てでは、管理グループ内のサブスクリプション レベルを対象にできます。
- 考えているポリシーが 1 つだけの場合でも、ポリシー定義ではなくイニシアチブ定義を常に使うことをお勧めします。 たとえば、ポリシー定義 *policyDefA* をイニシアチブ定義 *initiativeDefC* の下に作成すると、*policyDefA* と同じような目標を持つ *policyDefB* の別のポリシー定義を後で作成する場合、それを *initiativeDefC* の下に追加して適切に追跡できます。
- イニシアチブ定義からイニシアチブ割り当てを作成した場合、そのイニシアチブ定義に追加される新しいポリシー定義はすべて、そのイニシアチブ定義のイニシアチブ割り当てに自動的にまとめられることに注意してください。
- イニシアチブ割り当てがトリガーされると、イニシアチブ内のすべてのポリシーもトリガーされます。 ただし、ポリシーを個別に実行する必要がある場合は、ポリシーをイニシアティブに含めないことをお勧めします。

## <a name="video-overview"></a>ビデオの概要

次の Azure Policy の概要は、ビルド 2018 に基づいています。 スライドまたはビデオのダウンロードについては、チャンネル 9 の「[Govern your Azure environment through Azure Policy](https://channel9.msdn.com/events/Build/2018/THR2030)」(Azure Policy による Azure 環境の管理) を参照してください。

> [!VIDEO https://channel9.msdn.com/events/Build/2018/THR2030/player]

## <a name="next-steps"></a>次の手順

これで、Azure Policy の概要といくつかの主要な概念に関する説明は終了です。推奨される次の手順は以下のとおりです。

- [ポリシー定義を割り当てる](assign-policy-definition.md)
- [Azure CLI を使用してポリシー定義を割り当てる](assign-policy-definition-cli.md)
- [PowerShell を使用してポリシー定義を割り当てる](assign-policy-definition-ps.md)
- 「[Azure 管理グループのリソースを整理する](../azure-resource-manager/management-groups-overview.md)」で、管理グループとは何かを確認します。
- チャンネル 9 の「[Govern your Azure environment through Azure Policy](https://channel9.msdn.com/events/Build/2018/THR2030)」(Azure Policy による Azure 環境の管理) を視聴する