---
title: ポータルで Azure Search にデータをインポート | Microsoft Docs
description: Azure portal でデータのインポート ウィザードを使用して、Cosmos DB、Blob Storage、Table Storage、SQL Database、Azure VM 上の SQL Server から Azure データをクロールします。
author: HeidiSteen
manager: cgronlun
services: search
ms.service: search
ms.topic: conceptual
ms.date: 07/10/2018
ms.author: heidist
ms.openlocfilehash: dcdc0501d94191cf2c281a4f880ddab3db023fc0
ms.sourcegitcommit: e0a678acb0dc928e5c5edde3ca04e6854eb05ea6
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/13/2018
ms.locfileid: "39004947"
---
# <a name="how-to-import-data-into-azure-search-index-using-the-azure-portal"></a>Azure portal を使用して Azure Search インデックスにデータをインポートする方法

Azure Portal では、データをインデックスに読み込む**データのインポート** ウィザードが Azure Search ダッシュボードに用意されています。 

  ![Import Data on the command bar][1]

内部的には、このウィザードが " *インデクサー*" を構成して起動し、次のようなインデックス作成プロセスのいくつかの手順を自動化します。 

* 同じ Azure サブスクリプションで外部のデータ ソースに接続する
* ソースのデータ構造に基づいて変更可能なインデックス スキーマを生成する
* データ ソースから取得した行セットを使用してインデックスに JSON ドキュメントを読み込む

> [!NOTE]
> **データのインポート** ウィザードを Azure Cosmos DB ダッシュボードから起動して、そのデータ ソースのインデックス作成を簡略化できます。 左側のナビゲーションで、**[コレクション]** > **[Add Azure Search (Azure Search の追加)]** に移動します。

## <a name="data-sources-supported-by-the-import-data-wizard"></a>データのインポート ウィザードでサポートされるデータ ソース
データのインポート ウィザードでは、次のデータ ソースがサポートされています。 

* Azure SQL Database
* Azure VM 上の SQL Server のリレーショナル データ
* Azure Cosmos DB
* Azure BLOB ストレージ
* Azure テーブル ストレージ

フラット化されたデータセットの入力が必要です。 データは 1 つのテーブル、データベース ビュー、または同等のデータ構造からのみインポートできます。 ウィザードを実行する前に、このデータ構造を作成する必要があります。

## <a name="connect-to-your-data"></a>データへの接続
1. [Azure Portal](https://portal.azure.com) にサインインし、サービス ダッシュボードを開きます。 ジャンプ バーの **[すべてのサービス]** をクリックすると、現在のサブスクリプションの既存の "検索サービス" を検索できます。 

1. コマンド バーの **[データのインポート]** をクリックして、[データのインポート] ブレードを開きます。

1. **[データに接続します]** をクリックし、インデクサーで使用されるデータ ソースの定義を指定します。 サブスクリプション内のデータ ソースの場合、ウィザードは通常、接続情報を検出して読み取ることができ、全体的な構成要件を最小限に抑えます。

|  |  |
| --- | --- |
| **既存のデータ ソース** |Search サービスに定義済みのインデクサーが既にある場合は、別のインポート用に既存のデータ ソース定義を選択できます。 |
| **Azure SQL Database** |サービス名、読み取り権限を持つデータベース ユーザーの資格情報、データベース名は、このページで、または ADO.NET 接続文字列を使用して指定できます。 接続文字列のオプションを選択して、プロパティを表示またはカスタマイズします。 <br/><br/>行セットを提供するテーブルまたはビューは、このページで指定する必要があります。 このオプションは接続に成功すると表示され、ドロップダウン リストから選択できます。 |
| **Azure VM 上の SQL Server** |接続文字列として、完全修飾サービス名、ユーザー ID とパスワード、データベースを指定します。 このデータ ソースを使用するには、接続を暗号化する証明書をローカル ストアにあらかじめインストールしておく必要があります。 手順については、[Azure Search への SQL VM 接続](search-howto-connecting-azure-sql-iaas-to-azure-search-using-indexers.md)に関する記事をご覧ください。 <br/><br/>行セットを提供するテーブルまたはビューは、このページで指定する必要があります。 このオプションは接続に成功すると表示され、ドロップダウン リストから選択できます。 |
| **Azure Cosmos DB** |要件には、アカウント、データベース、コレクションが含まれます。 コレクション内のすべてのドキュメントはインデックスに含まれます。 クエリを定義して、行セットをフラット化またはフィルター処理したり、以降のデータ更新操作のためにドキュメントの変更を検出したりできます。 |
| **Azure Blob Storage** |要件には、ストレージ アカウントとコンテナーが含まれます。 BLOB 名がグループ化のために仮想名前付け規則に従っている場合は、必要に応じて、コンテナーの下のフォルダーとして名前の仮想ディレクトリの部分を指定できます。 詳しくは、[Blob Storage のインデックス作成](search-howto-indexing-azure-blob-storage.md)に関する記事をご覧ください。 |
| **Azure Table Storage** |要件には、ストレージ アカウントとテーブル名が含まれます。 必要に応じて、クエリを指定してテーブルのサブセットを取得できます。 詳しくは、[Table Storage のインデックス作成](search-howto-indexing-azure-tables.md)に関する記事をご覧ください。 |

## <a name="customize-target-index"></a>ターゲット インデックスのカスタマイズ
通常、インデックスは事前にデータセットから推測されます。 フィールドを追加、編集、削除してスキーマを完成させることができます。 さらに、フィールド レベルで属性を設定して、以降の検索動作を決定します。

1. **[対象インデックスをカスタマイズします]** で、各ドキュメントを一意に識別するために使用する名前と**キー**を指定します。 キーは文字列である必要があります。 フィールドの値に空白またはダッシュが含まれる場合は、 **[データのインポート]** の詳細オプションでこれらの文字の検証チェックを抑制するように設定してください。

1. 残りのフィールドを確認して修正します。 通常、フィールドの名前と型は既に設定されています。 インデックスが作成されるまでは、データ型を変更できます。 後で変更するには再構築が必要です。

1. 各フィールドのインデックスの属性を設定します。
   
   * Retrievable は、検索結果にフィールドを返します。
   * Filterable は、フィルター式でフィールドを参照できるようにします。
   * Sortable は、並べ替えでフィールドを使用できるようにします。
   * Facetable は、ファセット ナビゲーションにフィールドを使用できるようにします。
   * Searchable は、全文検索を実行できるようにします。

1. フィールド レベルで言語アナライザーを指定する場合は、 **[アナライザー]** タブをクリックします。 現時点では、言語アナライザーのみを指定できます。 カスタム アナライザーや、キーワード、パターンなどの非言語アナライザーを使用する場合は、コードが必要になります。
   
   * **[検索可能]** をクリックしてフィールドにフルテキスト検索を指定し、アナライザーのドロップダウン リストを有効にします。
   * 使用するアナライザーを選択します。 詳細については、[複数の言語によるドキュメントのインデックスの作成](search-language-support.md)に関するページを参照してください。

1. **[提案者]** をクリックして、選択したフィールドに先行入力クエリによる検索候補を有効にします。

## <a name="import-your-data"></a>[データのインポート]
1. **[データのインポート]** で、インデクサーの名前を指定します。 データのインポート ウィザードの成果物がインデクサーであることを思い出してください。 後でインデクサーの確認や編集を行う場合は、ウィザードを再実行するのではなく、ポータルから選択します。 

1. サービスがプロビジョニングされている地域のタイム ゾーンに基づいて、スケジュールを指定します。

1. 詳細オプションを設定して、ドキュメントが削除された場合にインデックス作成を継続できるかどうかを決めるしきい値を指定します。 また、 **[キー]** フィールドにスペースやスラッシュを含めることができるかどうかも指定できます。  

1. **[OK]** をクリックしてインデックスを作成し、データをインポートします。

ポータルでインデックス作成を監視することができます。 ドキュメントが読み込まれると、定義したインデックスのドキュメント数が増えます。 ポータル ページで最新の更新プログラムを取得するまで、数分かかる場合があります。

すべてのドキュメントが読み込まれるとすぐに、インデックスのクエリを実行する準備ができます。

## <a name="query-an-index-using-search-explorer"></a>Search エクスプローラーを使用してインデックスのクエリを実行する

ポータルに用意されている **Search エクスプローラー**を使用すると、コードを記述することなくインデックスを照会できます。 [Search エクスプローラー](search-explorer.md)は、任意のインデックスに対して使用できます。

検索エクスペリエンスは、既定の設定 ([単純構文](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search)、既定の [searchMode クエリ パラメーター](https://docs.microsoft.com/rest/api/searchservice/search-documents)など) に基づきます。 

結果は JSON で詳細な形式で返されるため、ドキュメント全体を調べることができます。

## <a name="edit-an-existing-indexer"></a>既存のインデクサーを編集する
前述のように、データのインポート ウィザードでは、ポータルでスタンドアロン構成として変更できる**インデクサー**が作成されます。

サービス ダッシュボードで [インデクサー] タイルをダブルクリックすると、サブスクリプションに作成されたすべてのインデクサーの一覧が表示されます。 インデクサーのいずれかをダブルクリックして、実行、編集、削除できます。 インデックスを既存の別のインデックスに置き換える、データ ソースを変更する、およびインデックス作成時のエラーのしきい値のオプションを設定することができます。

## <a name="edit-an-existing-index"></a>既存のインデックスを編集する
ウィザードでは**インデックス**も作成されます。 Azure Search では、インデックスに対して構造的な更新を行うには、そのインデックスを再構築する必要があります。 再構築には、インデックスの削除、必要な変更を含む改訂されたスキーマを使用したインデックスの再作成、データの再読み込みを伴います。 構造の更新には、データ型の変更、フィールド名の変更、フィールドの削除があります。

再構築する必要のない編集には、新しいフィールドの追加、スコアリング プロファイルの変更、サジェスターの変更、言語アナライザーの変更があります。 詳細については、 [インデックスの更新](https://msdn.microsoft.com/library/azure/dn800964.aspx) に関するページを参照してください。


## <a name="next-steps"></a>次の手順
インデクサーの詳細については、次のリンク先を参照してください。

* [Azure SQL Database のインデックス作成](search-howto-connecting-azure-sql-database-to-azure-search-using-indexers.md)
* [Azure Cosmos DB のインデックス作成](search-howto-index-cosmosdb.md)
* [Blob Storage のインデックス作成](search-howto-indexing-azure-blob-storage.md)
* [Table Storage のインデックス作成](search-howto-indexing-azure-tables.md)

<!--Image references-->
[1]: ./media/search-import-data-portal/search-import-data-command.png

