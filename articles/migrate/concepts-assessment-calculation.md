---
title: Azure Migrate のアセスメントの計算 | Microsoft Docs
description: Azure Migrate サービスにおけるアセスメントの計算の概要を説明します。
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: conceptual
ms.date: 07/25/2018
ms.author: raynew
ms.openlocfilehash: 7ffcf5e3c7e6f0cb3d344b7d148b6024e8469eff
ms.sourcegitcommit: a5eb246d79a462519775a9705ebf562f0444e4ec
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/26/2018
ms.locfileid: "39263011"
---
# <a name="assessment-calculations"></a>評価の計算

[Azure Migrate](migrate-overview.md) は、オンプレミスのワークロードを評価することによって、Azure への移行を支援します。 この記事では、アセスメントの計算方法について説明します。


## <a name="overview"></a>概要

Azure Migrate のアセスメントには、3 つの段階があります。 アセスメントは適合性分析から始まり、次にサイズ設定が行われ、最後に月間コストの見積もりが行われます。 前の段階で合格したマシンだけが次の段階に進みます。 たとえば、マシンが Azure 適合性チェックで不合格になった場合、Azure に不適合とマークされ、サイズとコストは計算されません。


## <a name="azure-suitability-analysis"></a>Azure 適合性分析

クラウドそのものに制限や要件があるため、すべてのマシンがクラウドでの実行に適しているわけではありません。 Azure Migrate は、オンプレミス マシンの Azure への移行適合性を計算して、次のいずれかにマシンを分類します。
- **[Ready for Azure]\(Azure に対応\)** - マシンをそのまま変更せずに Azure に移行できます。 Azure で起動し、Azure のフル サポートを受けます。
- **[Conditionally ready for Azure]\(条件付きで Azure に対応\)** - マシンは Azure で起動できますが、Azure のフル サポートを受けられない可能性があります。 たとえば、Windows Server OS の以前のバージョンのマシンは Azure ではサポートされません。 このようなマシンを Azure に移行する前には注意が必要です。アセスメントで示された修復ガイダンスに従い、対応に関する問題を修正してから移行します。
- **[Azure に未対応]** - マシンは Azure で起動しません。 たとえば、オンプレミス マシンに接続されているディスクのサイズが 4 TB を超える場合、Azure でホストすることはできません。 アセスメントで示された修復ガイダンスに従い、対応に関する問題を修正してから Azure に移行します。 [Azure に未対応] と分類されたマシンのサイズ調整とコスト見積もりは行われません。
- **[Readiness 不明]** - Azure Migrate は、vCenter Server にあるデータが不十分なためマシンの対応性を確認できませんでした。

Azure Migrate は、マシンのプロパティとゲスト オペレーティング システムを調べて、オンプレミス マシンの Azure 対応性を識別します。

### <a name="machine-properties"></a>マシンのプロパティ
Azure Migrate は、オンプレミス VM の次のプロパティを調べて、VM が Azure で実行できるかどうかを確認します。

**プロパティ** | **詳細** | **Azure 対応性の状態**
--- | --- | ---
**ブートの種類** | Azure は、ブートの種類が UEFI ではなく BIOS として VM をサポートします。 | ブートの種類が UEFI の場合は条件付きで対応します。
**コア** | マシンのコア数は、Azure VM でサポートされている最大コア数 (32) 以下である必要があります。<br/><br/> パフォーマンス履歴が使用可能な場合、Azure Migrate では、使用されているコアの数が比較で考慮されます。 アセスメント設定で快適性係数が指定されている場合、使用されているコアの数に快適性係数が乗算されます。<br/><br/> パフォーマンス履歴がない場合は、快適性係数を適用せずに、割り当てられているコアの数が使用されます。 | 制限以下の場合は対応します。
**メモリ** | マシンのメモリ サイズは、Azure VM で許容される最大メモリ (Azure M シリーズ Standard_M128m&nbsp;<sup>2</sup> で 3892 GB) 以下である必要があります。 [詳細情報](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sizes-memory.md#m-series)。<br/><br/> パフォーマンス履歴が使用可能な場合、Azure Migrate では、使用されているメモリが比較で考慮されます。 快適性係数が指定されている場合、使用されているメモリに快適性係数が乗算されます。<br/><br/> 履歴がない場合は、快適性係数を適用せずに、割り当てられているメモリが使用されます。<br/><br/> | 制限内であれば対応します。
**ストレージ ディスク** | ディスクの割り当てサイズは、4 TB (4,096 GB) 以下である必要があります。<br/><br/> マシンに接続されているディスクの数は、OS ディスクを含めて 65 個以下である必要があります。 | 制限内であれば対応します。
**ネットワーク** | マシンに接続されている NIC の数は、32 個以下である必要があります。 | 制限内であれば対応します。

### <a name="guest-operating-system"></a>ゲスト オペレーティング システム
Azure Migrate は、VM プロパティと共にオンプレミス VM のゲスト OS を調べて、VM が Azure で実行できるかどうかを確認します。

> [!NOTE]
> Azure Migrate は、vCenter Server に指定された OS を考慮して、次の分析を実行します。 Azure Migrate による検出はアプライアンスに基づいているため、VM 内で実行している OS が vCenter Server に指定された OS と同じかどうかを確かめることができません。

Azure Migrate は次のロジックを使用して、オペレーティング システムに基づいた VM の Azure 対応を識別します。

**オペレーティング システム** | **詳細** | **Azure 対応性の状態**
--- | --- | ---
Windows Server 2016 および全 SP | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2012 R2 および全 SP | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2012 および全 SP | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2008 R2 および全 SP | Azure は完全サポートを提供します。| Azure に対応
Windows Server 2008 (32 ビットおよび 64 ビット) | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2003、2003 R2 | これらのオペレーティング システムはサポート終了日が過ぎているため、Azure でのサポートには[カスタム サポート契約 (CSA)](https://aka.ms/WSosstatement) が必要です。 | Azure 条件付きで対応。Azure に移行する前に OS のアップグレードを検討してください。
Windows 2000、98、95、NT、3.1、MS-DOS | これらのオペレーティング システムはサポート終了日が過ぎています。マシンは Azure で起動できますが、Azure による OS のサポートは提供されません。 | Azure に条件付きで対応。Azure に移行する前に OS のアップグレードをお勧めします。
Windows Client 7、8、10 | Azure は、Visual Studio サブスクリプションでのみサポートを提供します。 | Azure に条件付きで対応
Windows Vista、XP Professional | これらのオペレーティング システムはサポート終了日が過ぎています。マシンは Azure で起動できますが、Azure による OS のサポートは提供されません。 | Azure に条件付きで対応。Azure に移行する前に OS のアップグレードをお勧めします。
Linux | Azure はこれらの [Linux オペレーティング システム](../virtual-machines/linux/endorsed-distros.md)をサポートしています。 他の Linux オペレーティング システムは Azure で起動できますが、Azure へ移行する前に、サポートされるバージョンへの OS のアップグレードをお勧めします。 | Azure に対応 (バージョンがサポートされている場合)。<br/><br/>条件付きで対応 (バージョンがサポートされていない場合)。
他のオペレーティング システム<br/><br/> 例: Oracle Solaris、Apple Mac OS、FreeBSD など | Azure では、これらのオペレーティング システムはサポートされません。 マシンは Azure で起動できますが、Azure による OS サポートは提供されません。 | Azure に条件付きで対応。Azure に移行する前にサポート対象の OS のインストールをお勧めします。  
vCenter Server で **[Other]\(その他\)** と指定された OS | この場合、Azure Migrate は OS を識別できません。 | 対応不明。 VM で実行している OS が Azure でサポートされることを確認します。
32 ビット オペレーティング システム | マシンは Azure で起動できますが、Azure がフル サポートを提供しない可能性があります。 | 条件付きで Azure に対応。Azure に移行する前に、マシンの OS を 32 ビット OS から 64 ビット OS にアップグレードすることをご検討ください。

## <a name="sizing"></a>サイズ変更

マシンが Azure に対応すると分類されたら、Azure Migrate は VM とそのディスクのサイズを Azure 用に設定します。 アセスメント プロパティで指定されたサイズ設定基準がパフォーマンスに基づいたサイズ設定の場合、Azure Migrate はマシンのパフォーマンス履歴を考慮して、Azure での VM サイズとディスクの種類を指定します。 この方法が役立つのは、オンプレミスの割り当て数が多いが使用率が低い場合に、Azure での VM のサイズを適切に設定してコストを節約するシナリオです。

> [!NOTE]
> Azure Migrate は、オンプレミス VM のパフォーマンス履歴を vCenter Server から収集します。 適切なサイズを正確に設定するためには、vCenter Server の統計設定をレベル 3 に設定し、少なくとも 1 日待機してから、オンプレミス VM の検出を開始してください。 vCenter Server の統計設定がレベル 3 未満である場合、ディスクおよびネットワークのパフォーマンス データは収集されません。

VM のサイズ変更のパフォーマンス履歴を検討せずに、VM をそのまま Azure に移行する場合は、サイズ設定基準を *[オンプレミス]* と指定すると、Azure Migrate は使用状況データを考慮せずにオンプレミス構成に基づいて VM のサイズを設定します。 ディスクのサイズ変更、ここではアセスメントプロパティで指定した Storage の種類 (Standard ディスクまたは Premium ディスク) に基づいて行う

### <a name="performance-based-sizing"></a>パフォーマンス ベースのサイズ設定

パフォーマンスベースのサイズ設定では、Azure Migrate は、まず VM に接続されているディスク、次にネットワーク アダプターのサイズを設定し、その後、オンプレミス VM のコンピューティング要件に基づいて Azure VM をマップします。

- **ストレージ**: Azure Migrate は、マシンに接続されているすべてのディスクを Azure のディスクにマップしようとします。

    > [!NOTE]
    > アセスメントで Azure Migrate は管理ディスクのみをサポートします。

    - 効果的な 1 秒あたりのディスク I/O (IOPS) やスループット (MBps) を取得するため、Azure Migrate はディスク IOPS とスループットに快適性係数を掛けます。 IOPS とスループットの効果的な値に基づいて、Azure Migrate は、ディスクを Azure の Standard ディスクと Premium ディスクのどちらにマップするかを指定します。
    - 必要な IOPS とスループットのディスクが見つからない場合、そのマシンは Azure に不適合とマークされます。 ディスクおよび VM あたりの Azure の制限の詳細については、[こちら](../azure-subscription-service-limits.md#storage-limits)をご覧ください。
    - 一連の適切なディスクが見つかった場合は、ストレージ冗長化と、アセスメント設定で指定された場所をサポートするディスクが選択されます。
    - 対象となるディスクが複数ある場合は、最も低コストのディスクが選択されます。
    - ディスクのパフォーマンス データが得られない場合、すべてのディスクが Azure の Standard ディスクにマップされます。

- **ネットワーク**: Azure Migrate は、オンプレミス マシンに接続されたネットワーク アダプター数およびそれらのネットワーク アダプターで必要なパフォーマンスをサポートできる Azure VM を見つけようとします。
    - オンプレミス VM の効果的なネットワーク パフォーマンスを取得するために、Azure Migrate は、すべてのネットワーク アダプターについてマシンから送信される 1 秒あたりのデータ容量 (MBps) (ネットワーク出力) を集計し、快適性係数を適用します。 この数値は、必要なネットワーク パフォーマンスをサポートできる Azure VM を見つけるために使用されます。
    - ネットワーク パフォーマンスと共に、Azure VM が必要なネットワーク アダプター数をサポートできるかどうかも考慮されます。
    - ネットワーク パフォーマンス データが使用できない場合は、VM のサイズ設定でネットワーク アダプター数だけが考慮されます。

- **コンピューティング**: ストレージとネットワークの要件を計算したら、Azure Migrate は CPU とメモリの要件を考慮して、Azure での適切な VM サイズを求めます。
    - Azure Migrate は、使用されているコアとメモリを調べて、快適性係数を適用して効果的なコア数とメモリを取得します。 その数値に基づいて、Azure の適切な VM サイズを見つけることを試みます。
    - 適切なサイズが見つからない場合、そのマシンは Azure に不適合とマークされます。
    - 適切なサイズが見つかった場合は、ストレージとネットワークの計算が適用されます。 その後、場所と価格レベルの設定が適用され、VM サイズの最終的な推奨事項が作成されます。
    - 条件を満たす Azure VM サイズが複数ある場合、最も低コストのディスクをお勧めします。

### <a name="as-on-premises-sizing"></a>オンプレミスのサイズ設定
サイズ設定基準が "*オンプレミスと同じサイズ* " の場合、Azure Migrate は VM とディスク のパフォーマンス履歴を考慮せず、オンプレミスで割り当てられたサイズに基づいて VM SKU を Azure に割り当てます。 ディスクのサイズ変更についても同様に、アセスメントプロパティで指定された Storage の種類 (Standard または Premium) を見てディスクの種類を適宜お勧めします。 既定の Storage の種類は、Premium ディスクです。

### <a name="confidence-rating"></a>信頼度レーティング
Azure Migrate のパフォーマンスベースの各評価は、1 つ星から 5 つ星 (1 つ星が最低で 5 つ星が最高) の範囲の信頼度レーティングに関連付けられています。 信頼度レーティングは、評価の計算に必要なデータ ポイントの可用性に基づいて、評価に割り当てられます。 評価の信頼度レーティングは、Azure Migrate による推奨サイズの信頼性を判断する目安となります。 信頼度レーティングは、オンプレミスの評価としては適用されません。

サイズ変更がパフォーマンス ベースの場合、Azure Migrate には VM の CPU とメモリの使用率データが必要です。 さらに、VM に接続されている各ディスクについて、ディスクの IOPS とスループットのデータが必要です。 同様に、サイズ変更をパフォーマンス ベースで行う場合、Azure Migrate には VM に接続されている各ネットワーク アダプターについても、ネットワークの入出力が必要です。 上記の使用率の数値のいずれかが vCenter Server にない場合、Azure Migrate による推奨サイズは信頼できないことがあります。 次のように、使用可能なデータ ポイントの割合に応じて、評価の信頼度レーティングが決まります。

   **データ ポイントの可用性** | **信頼度レーティング**
   --- | ---
   0% - 20% | 1 つ星
   21% - 40% | 2 つ星
   41% - 60% | 3 つ星
   61% - 80% | 4 つ星
   81% - 100% | 5 つ星

以下のいずれかの理由により、評価ですべてのデータ ポイントを使用することができない場合があります。
- vCenter Server の統計情報設定が、レベル 3 に設定されていません。 vCenter Server の統計設定がレベル 3 未満である場合、ディスクおよびネットワークのパフォーマンス データが vCenter Server から収集されません。 この場合、ディスクとネットワークに関して Azure Migrate から提示される推奨情報は、使用率ベースではありません。 ディスクの IOPS/スループットを考慮しないと、Azure Migrateは、Azure でプレミアム ディスクが必要であるかどうかを判断できないため、この場合、Azure Migrate はすべてのディスクに Standard ディスクを推奨します。
- vCenter Server の統計設定は、検出を開始する前に、短期間レベル 3 に設定されていました。 たとえば、今日、統計設定レベルを 3 に変更し、明日 (24 時間後) にコレクター アプライアンスを使用して検出を開始するシナリオを考えてみましょう。 1 日の評価を作成するのであれば、すべてのデータ ポイントが使用でき、評価の信頼度レーティングは 5 つ星になります。 しかし、評価プロパティのパフォーマンス期間を 1 か月に変更すると、過去 1 か月のディスクおよびネットワークのパフォーマンス データは利用できないため、信頼度レーティングは低下します。 過去 1 か月間のパフォーマンス データを考慮する場合は、検出を開始する前の 1 か月間、vCenter Server の統計設定をレベル 3 に保つことをお勧めします。
- 評価の計算対象である期間中に、いくつかの VM がシャットダウンされました。 いくつかの VM でしばらくの間電源がオフになっていた場合、vCenter Server はその期間のパフォーマンス データを使用できなくなります。
- 評価の計算対象である期間中に、いくつかの VM が作成されました。 たとえば、過去 1 か月間のパフォーマンス履歴の評価を作成しているのに、ほんの 1 週間前にいくつかの VM が環境内に作成されたとします。 このような場合、新しい VM のパフォーマンス履歴は、期間全体にわたっては存在しません。

> [!NOTE]
> 評価の信頼度レーティングが 4 つ星未満の場合は、vCenter Server の統計設定レベルを 3 に変更し、評価対象として考慮する期間 (1 日/1 週間/1 か月) 待機してから検出と評価を行うことをお勧めします。 そのようにできない場合は、パフォーマンス ベースのサイズ変更を信頼できないことがあるため、評価プロパティを変更して、"*オンプレミスと同じサイズ*" に切り替えることをお勧めします。

## <a name="monthly-cost-estimation"></a>月間コスト見積もり

サイズ設定に関する推奨事項が完成すると、Azure Migrate は移行後のコンピューティング コストとストレージ コストを計算します。

- **コンピューティング コスト**: Azure Migrate は、Billing API を使用して、推奨される Azure VM サイズで VM の月間コストを計算します。 この計算では、オペレーティング システム、ソフトウェア アシュアランス、予約インスタンス、VM のアップタイム、場所、および通貨の設定が考慮されます。 すべてのマシンのコストが集計され、月間コンピューティング コストの合計が計算されます。
- **ストレージ コスト**: マシンの月間ストレージ コストは、マシンに接続されているすべてのディスクの月間コストを集計することによって計算されます。 Azure Migrate は、すべてのマシンのストレージ コストを集計して、月間ストレージ コストの合計を計算します。 現在、この計算では、アセスメント設定で指定されたプランは考慮されません。

コストは、アセスメント設定で指定された通貨で表示されます。


## <a name="next-steps"></a>次の手順

[オンプレミスの VMware VM のアセスメントを作成する](tutorial-assessment-vmware.md)
